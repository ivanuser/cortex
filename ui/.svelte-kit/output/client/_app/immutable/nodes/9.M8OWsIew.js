import{d as Nt,a as D,b as v,f as p,s as c,t as ie,e as Tt}from"../chunks/B2A7gHtL.js";import{p as zt,s as A,a as Dt,u as ze,b as Ft,d as w,t as x,c as Ht,e as Pt,g as e,f as i,$ as Et,h as n,r,i as F,j as Ut}from"../chunks/qR_TM3YX.js";import{i as f}from"../chunks/DpBBTLWw.js";import{g as Ot,a as H,s as V,e as C,i as L,b as De}from"../chunks/BhtVncI_.js";import{h as Rt}from"../chunks/CXQ1lKJR.js";import{s as qt}from"../chunks/tr5b7CMr.js";import{g as Gt}from"../chunks/Be_uRYmX.js";var Jt=p('<div class="flex items-center gap-1.5 mt-3 text-xs"><span class="w-2 h-2 rounded-full bg-accent-green glow-pulse"></span> <span class="text-text-muted">Active instances:</span> <span class="text-accent-green font-mono font-semibold"> </span></div>'),Qt=p('<div class="flex flex-col items-center justify-center h-full text-center"><div class="w-16 h-16 rounded-2xl bg-bg-tertiary border border-border-default flex items-center justify-center mb-4"><svg class="w-8 h-8 text-text-muted" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636a9 9 0 010 12.728m-2.829-2.829a5 5 0 000-7.07"></path></svg></div> <p class="text-text-muted text-sm">Connect to the gateway to view instances.</p></div>'),Wt=p('<div class="glass rounded-xl p-4 border border-accent-pink/30 mb-4"><div class="flex items-center gap-2 text-accent-pink text-sm"><svg class="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <span> </span></div></div>'),Xt=p('<div class="glass rounded-xl p-5 border border-border-default animate-pulse"><div class="h-4 w-40 bg-bg-tertiary rounded mb-2"></div> <div class="h-3 w-64 bg-bg-tertiary rounded mb-3"></div> <div class="flex gap-2"><div class="h-5 w-14 bg-bg-tertiary rounded-full"></div> <div class="h-5 w-14 bg-bg-tertiary rounded-full"></div></div></div>'),Yt=p('<div class="flex flex-col gap-3"></div>'),Zt=p('<div class="flex flex-col items-center justify-center h-64 text-center"><p class="text-text-muted text-sm">No instances reported yet.</p></div>'),ea=p('<span class="text-xs text-text-muted"> </span>'),ta=p('<span class="text-text-muted/50"> </span>'),aa=p('<span class="px-2 py-0.5 rounded-full text-[10px] font-medium bg-accent-cyan/10 text-accent-cyan border border-accent-cyan/20"> </span>'),ra=p('<span class="px-2 py-0.5 rounded-full text-[10px] font-medium bg-accent-purple/10 text-accent-purple border border-accent-purple/20"> </span>'),sa=p('<span class="px-2 py-0.5 rounded-full text-[10px] font-medium bg-bg-tertiary text-text-muted border border-border-default"> </span>'),oa=p('<span class="px-2 py-0.5 rounded-full text-[10px] font-medium bg-accent-green/10 text-accent-green border border-accent-green/10"> </span>'),na=p('<span class="px-2 py-0.5 rounded-full text-[10px] font-medium bg-bg-tertiary text-text-muted border border-border-default"> </span>'),ia=p('<span class="px-2 py-0.5 rounded-full text-[10px] font-medium bg-accent-purple/10 text-purple-300 border border-accent-purple/10"> </span>'),da=p('<span class="px-2 py-0.5 rounded-full text-[10px] font-medium bg-accent-amber/10 text-accent-amber border border-accent-amber/10"> </span>'),la=p('<div class="flex items-center gap-1 justify-end"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> </div>'),va=p("<div> </div>"),ca=p('<div class="text-text-muted/60"> </div>'),pa=p('<div class="flex items-center gap-1"><button><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg> </button> <button><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> </button></div>'),xa=p('<div class="col-span-2 md:col-span-3"><span class="text-text-muted block mb-0.5">Session Key</span> <span class="text-text-primary font-mono text-[10px] break-all"> </span></div>'),ua=p('<div><span class="text-text-muted block mb-0.5">Model</span> <span class="text-accent-purple font-mono"> </span></div>'),fa=p('<span class="px-1.5 py-0.5 rounded text-[10px] bg-bg-tertiary text-text-muted border border-border-default font-mono"> </span>'),ma=p('<div class="col-span-2 md:col-span-3"><span class="text-text-muted block mb-0.5">Scopes</span> <div class="flex flex-wrap gap-1 mt-1"></div></div>'),ba=p('<span class="px-1.5 py-0.5 rounded text-[10px] bg-accent-green/10 text-accent-green border border-accent-green/10 font-mono"> </span>'),_a=p('<div class="col-span-2 md:col-span-3"><span class="text-text-muted block mb-0.5">Capabilities</span> <div class="flex flex-wrap gap-1 mt-1"></div></div>'),ga=p('<div class="px-4 pb-4 border-t border-border-default/50 pt-3 animate-fade-in"><div class="grid grid-cols-2 md:grid-cols-3 gap-3 text-xs"><div><span class="text-text-muted block mb-0.5">Mode</span> <span class="text-text-primary font-mono"> </span></div> <div><span class="text-text-muted block mb-0.5">Platform</span> <span class="text-text-primary font-mono"> </span></div> <div><span class="text-text-muted block mb-0.5">Device</span> <span class="text-text-primary font-mono"> </span></div> <div><span class="text-text-muted block mb-0.5">Model ID</span> <span class="text-text-primary font-mono"> </span></div> <div><span class="text-text-muted block mb-0.5">Client Version</span> <span class="text-text-primary font-mono"> </span></div> <div><span class="text-text-muted block mb-0.5">Client ID</span> <span class="text-text-primary font-mono"> </span></div> <!> <!> <!> <!></div></div>'),ha=p('<div class="rounded-xl border border-border-default bg-bg-secondary/50 hover:border-accent-cyan/20 transition-all animate-fade-in"><div class="p-4"><div class="flex items-start justify-between gap-4"><div class="min-w-0 flex-1"><div class="flex items-center gap-2 mb-1.5"><span></span> <h3 class="text-sm font-semibold text-text-primary truncate"> </h3> <!></div> <p class="text-xs text-text-muted mb-2"><!> <!> <!> <!></p> <div class="flex flex-wrap gap-1.5"><!> <!> <!> <!> <!> <!></div></div> <div class="flex flex-col items-end gap-2 flex-shrink-0"><div class="text-right text-xs text-text-muted space-y-0.5"><!> <!> <!></div> <!> <button class="flex items-center gap-1 text-[10px] text-text-muted hover:text-accent-cyan transition-colors"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg> </button></div></div></div> <!></div>'),ka=p('<div class="flex flex-col gap-3"></div>'),wa=p('<div class="h-full flex flex-col overflow-hidden"><div class="flex-shrink-0 p-4 md:p-6 pb-4 border-b border-border-default"><div class="flex items-start justify-between gap-4 flex-wrap"><div class="flex items-center gap-3"><div class="w-10 h-10 rounded-xl gradient-bg border border-border-glow flex items-center justify-center"><svg class="w-5 h-5 text-accent-cyan" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.636 18.364a9 9 0 010-12.728m12.728 0a9 9 0 010 12.728M12 12h.01"></path></svg></div> <div><h1 class="text-xl font-bold text-text-primary glow-text-cyan">Connected Instances</h1> <p class="text-sm text-text-muted">Presence beacons from the gateway and clients</p></div></div> <button class="flex items-center gap-1.5 px-3 py-1.5 text-sm bg-bg-tertiary border border-border-default rounded-lg text-text-secondary hover:text-accent-cyan hover:border-accent-cyan/30 transition-all disabled:opacity-40 disabled:cursor-not-allowed"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg> </button></div> <!></div> <div class="flex-1 overflow-y-auto p-4 md:p-6"><!></div></div>');function Sa(Fe,He){zt(He,!0);const P=Ot(),E=Gt();let y=A(Dt([])),M=A(!1),B=A(null),de=A(null),U=A(null);async function O(){if(!(!H.connected||e(M))){w(M,!0),w(B,null);try{const o=await H.call("system-presence",{});Array.isArray(o)?w(y,o,!0):o&&Array.isArray(o.entries)?w(y,o.entries,!0):w(y,[],!0)}catch(o){w(B,String(o),!0)}finally{w(M,!1)}}}async function le(o,l,u){if(!o.sessionKey){E.error("No Session","This instance has no active session to patch");return}w(U,l,!0);try{await H.call("sessions.patch",{key:o.sessionKey,...u}),E.success("Updated","Session settings saved"),await O()}catch(t){E.error("Failed",String(t))}finally{w(U,null)}}async function Pe(o,l){const u=["off","on","stream"],t=o.thinkingLevel??"off",m=u.indexOf(t),N=u[(m+1)%u.length];await le(o,l,{thinkingLevel:N})}async function Ee(o,l){const t=(o.verboseLevel??"off")==="off"?"on":"off";await le(o,l,{verboseLevel:t})}function Ue(o){if(typeof o!="number"||o<=0)return"—";const l=Math.floor(o/1e3),u=Math.floor(l/60),t=Math.floor(u/60),m=Math.floor(t/24);return m>0?`${m}d ${t%24}h`:t>0?`${t}h ${u%60}m`:u>0?`${u}m`:`${l}s`}function Oe(o){return o==null?"—":o<60?`${o}s ago`:o<3600?`${Math.floor(o/60)}m ago`:o<86400?`${Math.floor(o/3600)}h ago`:`${Math.floor(o/86400)}d ago`}function Re(o){return o.lastInputSeconds!=null?o.lastInputSeconds<300?"online":o.lastInputSeconds<3600?"idle":"stale":"online"}let qe=F(()=>[...e(y)].sort((o,l)=>{const u=o.mode==="gateway"?0:1,t=l.mode==="gateway"?0:1;return u!==t?u-t:(l.uptimeMs??0)-(o.uptimeMs??0)}));ze(()=>{P.state.status==="connected"&&Ft(()=>O())}),ze(()=>H.on("system-presence",l=>{Array.isArray(l)&&w(y,l,!0)}));var R=wa();Rt("aye7dn",o=>{Pt(()=>{Et.title="Instances — Cortex"})});var q=n(R),G=n(q),K=i(n(G),2),ve=n(K),Ge=i(ve);r(K),r(G);var Je=i(G,2);{var Qe=o=>{var l=Jt(),u=i(n(l),4),t=n(u,!0);r(u),r(l),x(()=>c(t,e(y).length)),v(o,l)};f(Je,o=>{e(y).length>0&&o(Qe)})}r(q);var ce=i(q,2),We=n(ce);{var Xe=o=>{var l=Qt();v(o,l)},Ye=o=>{var l=Wt(),u=n(l),t=i(n(u),2),m=n(t,!0);r(t),r(u),r(l),x(()=>c(m,e(B))),v(o,l)},Ze=o=>{var l=Yt();C(l,20,()=>Array(3),L,(u,t)=>{var m=Xt();v(u,m)}),r(l),v(o,l)},et=o=>{var l=Zt();v(o,l)},tt=o=>{var l=ka();C(l,21,()=>e(qe),L,(u,t,m)=>{const N=F(()=>Re(e(t))),T=F(()=>e(de)===m),pe=F(()=>e(U)===m);var z=ha();qt(z,`animation-delay: ${m*50}ms`);var J=n(z),xe=n(J),Q=n(xe),W=n(Q),ue=n(W),X=i(ue,2),at=n(X,!0);r(X);var rt=i(X,2);{var st=a=>{var s=ea(),d=n(s);r(s),x(()=>c(d,`(${e(t).host??""})`)),v(a,s)};f(rt,a=>{e(t).displayName&&e(t).host&&e(t).displayName!==e(t).host&&a(st)})}r(W);var Y=i(W,2),fe=n(Y);{var ot=a=>{var s=ie();x(()=>c(s,e(t).platform)),v(a,s)};f(fe,a=>{e(t).platform&&a(ot)})}var me=i(fe,2);{var nt=a=>{var s=ie();x(()=>c(s,`· ${e(t).deviceFamily??""}`)),v(a,s)};f(me,a=>{e(t).deviceFamily&&a(nt)})}var be=i(me,2);{var it=a=>{var s=ie();x(()=>c(s,`· ${e(t).modelIdentifier??""}`)),v(a,s)};f(be,a=>{e(t).modelIdentifier&&a(it)})}var dt=i(be,2);{var lt=a=>{var s=ta(),d=n(s);r(s),x(()=>c(d,`· ${e(t).clientId??""}`)),v(a,s)};f(dt,a=>{e(t).clientId&&e(t).clientId!==e(t).host&&a(lt)})}r(Y);var _e=i(Y,2),ge=n(_e);{var vt=a=>{var s=aa(),d=n(s,!0);r(s),x(()=>c(d,e(t).mode)),v(a,s)};f(ge,a=>{e(t).mode&&a(vt)})}var he=i(ge,2);C(he,17,()=>e(t).roles??[],L,(a,s)=>{var d=ra(),g=n(d,!0);r(d),x(()=>c(g,e(s))),v(a,d)});var ke=i(he,2);{var ct=a=>{var s=sa(),d=n(s);r(s),x(()=>c(d,`v${e(t).clientVersion??e(t).version??""}`)),v(a,s)};f(ke,a=>{(e(t).version||e(t).clientVersion)&&a(ct)})}var we=i(ke,2);{var pt=a=>{var s=Tt(),d=Ut(s);C(d,17,()=>e(t).capabilities??[],L,(g,h)=>{var $=oa(),S=n($,!0);r($),x(()=>c(S,e(h))),v(g,$)}),v(a,s)},xt=a=>{var s=na(),d=n(s);r(s),x(()=>c(d,`${(e(t).scopes??[]).length??""} scopes`)),v(a,s)};f(we,a=>{(e(t).capabilities??[]).length>0?a(pt):(e(t).scopes??[]).length>0&&a(xt,1)})}var ye=i(we,2);{var ut=a=>{var s=ia(),d=n(s,!0);r(s),x(()=>c(d,e(t).model)),v(a,s)};f(ye,a=>{e(t).model&&a(ut)})}var ft=i(ye,2);{var mt=a=>{var s=da(),d=n(s,!0);r(s),x(()=>c(d,e(t).agentId)),v(a,s)};f(ft,a=>{e(t).agentId&&a(mt)})}r(_e),r(Q);var Me=i(Q,2),Z=n(Me),$e=n(Z);{var bt=a=>{var s=la(),d=i(n(s));r(s),x(g=>c(d,` Up ${g??""}`),[()=>Ue(e(t).uptimeMs)]),v(a,s)};f($e,a=>{e(t).uptimeMs&&a(bt)})}var Ie=i($e,2);{var _t=a=>{var s=va(),d=n(s);r(s),x(g=>c(d,`Input ${g??""}`),[()=>Oe(e(t).lastInputSeconds)]),v(a,s)};f(Ie,a=>{e(t).lastInputSeconds!=null&&a(_t)})}var gt=i(Ie,2);{var ht=a=>{var s=ca(),d=n(s,!0);r(s),x(()=>c(d,e(t).reason)),v(a,s)};f(gt,a=>{e(t).reason&&a(ht)})}r(Z);var je=i(Z,2);{var kt=a=>{var s=pa(),d=n(s),g=i(n(d));r(d);var h=i(d,2),$=i(n(h));r(h),r(s),x(()=>{d.disabled=e(pe),V(d,1,`flex items-center gap-1 px-2 py-1 rounded-lg text-[10px] font-medium border transition-all disabled:opacity-50
                          ${e(t).thinkingLevel==="stream"?"bg-accent-cyan/15 text-accent-cyan border-accent-cyan/30":e(t).thinkingLevel==="on"?"bg-accent-purple/15 text-accent-purple border-accent-purple/30":"bg-bg-tertiary text-text-muted border-border-default hover:border-accent-cyan/30"}`),De(d,"title",`Thinking: ${e(t).thinkingLevel??"off"??""}`),c(g,` T:${e(t).thinkingLevel??"off"??""}`),h.disabled=e(pe),V(h,1,`flex items-center gap-1 px-2 py-1 rounded-lg text-[10px] font-medium border transition-all disabled:opacity-50
                          ${e(t).verboseLevel==="on"?"bg-accent-green/15 text-accent-green border-accent-green/30":"bg-bg-tertiary text-text-muted border-border-default hover:border-accent-green/30"}`),De(h,"title",`Verbose: ${e(t).verboseLevel??"off"??""}`),c($,` V:${e(t).verboseLevel??"off"??""}`)}),D("click",d,()=>Pe(e(t),m)),D("click",h,()=>Ee(e(t),m)),v(a,s)};f(je,a=>{e(t).sessionKey&&a(kt)})}var ee=i(je,2),Ce=n(ee),wt=i(Ce);r(ee),r(Me),r(xe),r(J);var yt=i(J,2);{var Mt=a=>{var s=ga(),d=n(s),g=n(d),h=i(n(g),2),$=n(h,!0);r(h),r(g);var S=i(g,2),Le=i(n(S),2),$t=n(Le,!0);r(Le),r(S);var te=i(S,2),Se=i(n(te),2),It=n(Se,!0);r(Se),r(te);var ae=i(te,2),Ae=i(n(ae),2),jt=n(Ae,!0);r(Ae),r(ae);var re=i(ae,2),Ve=i(n(re),2),Ct=n(Ve,!0);r(Ve),r(re);var se=i(re,2),Be=i(n(se),2),Lt=n(Be,!0);r(Be),r(se);var Ke=i(se,2);{var St=b=>{var _=xa(),k=i(n(_),2),I=n(k,!0);r(k),r(_),x(()=>c(I,e(t).sessionKey)),v(b,_)};f(Ke,b=>{e(t).sessionKey&&b(St)})}var Ne=i(Ke,2);{var At=b=>{var _=ua(),k=i(n(_),2),I=n(k,!0);r(k),r(_),x(()=>c(I,e(t).model)),v(b,_)};f(Ne,b=>{e(t).model&&b(At)})}var Te=i(Ne,2);{var Vt=b=>{var _=ma(),k=i(n(_),2);C(k,21,()=>e(t).scopes??[],L,(I,oe)=>{var j=fa(),ne=n(j,!0);r(j),x(()=>c(ne,e(oe))),v(I,j)}),r(k),r(_),v(b,_)};f(Te,b=>{(e(t).scopes??[]).length>0&&b(Vt)})}var Bt=i(Te,2);{var Kt=b=>{var _=_a(),k=i(n(_),2);C(k,21,()=>e(t).capabilities??[],L,(I,oe)=>{var j=ba(),ne=n(j,!0);r(j),x(()=>c(ne,e(oe))),v(I,j)}),r(k),r(_),v(b,_)};f(Bt,b=>{(e(t).capabilities??[]).length>0&&b(Kt)})}r(d),r(s),x(()=>{c($,e(t).mode??"—"),c($t,e(t).platform??"—"),c(It,e(t).deviceFamily??"—"),c(jt,e(t).modelIdentifier??"—"),c(Ct,e(t).clientVersion??e(t).version??"—"),c(Lt,e(t).clientId??"—")}),v(a,s)};f(yt,a=>{e(T)&&a(Mt)})}r(z),x(()=>{V(ue,1,`w-2 h-2 rounded-full flex-shrink-0
                      ${e(N)==="online"?"bg-accent-green glow-pulse":e(N)==="idle"?"bg-accent-amber":"bg-text-muted"}`),c(at,e(t).displayName??e(t).host??"unknown host"),V(Ce,0,`w-3.5 h-3.5 transition-transform ${e(T)?"rotate-180":""}`),c(wt,` ${e(T)?"Less":"Details"}`)}),D("click",ee,()=>w(de,e(T)?null:m,!0)),v(u,z)}),r(l),v(o,l)};f(We,o=>{P.state.status!=="connected"?o(Xe):e(B)?o(Ye,1):e(M)&&e(y).length===0?o(Ze,2):e(y).length===0?o(et,3):o(tt,!1)})}r(ce),r(R),x(()=>{K.disabled=e(M)||P.state.status!=="connected",V(ve,0,`w-4 h-4 ${e(M)?"animate-spin":""}`),c(Ge,` ${e(M)?"Loading…":"Refresh"}`)}),D("click",K,O),v(Fe,R),Ht()}Nt(["click"]);export{Sa as component};
