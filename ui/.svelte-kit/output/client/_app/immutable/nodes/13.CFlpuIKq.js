import{d as ke,a as Me,b as i,f as x,s as v,c as $e,t as oe}from"../chunks/B2A7gHtL.js";import{p as Ce,d as w,g as e,u as je,b as Ae,t as k,c as Se,s as D,e as De,f as o,h as a,$ as Ve,n as z,r as t,i as V,l as Ie}from"../chunks/qR_TM3YX.js";import{i as M}from"../chunks/DpBBTLWw.js";import{g as Be,a as L,e as T,i as J,s as W,b as Oe}from"../chunks/BhtVncI_.js";import{h as Re}from"../chunks/CXQ1lKJR.js";import{g as ze}from"../chunks/9SZhwvK0.js";import"../chunks/Be_uRYmX.js";var Le=$e('<svg class="w-4 h-4 animate-spin inline mr-1" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg>'),Ne=x('<div class="rounded-xl border border-border-default bg-bg-secondary/50 p-4 animate-pulse"><div class="h-3 w-16 bg-bg-tertiary rounded mb-3"></div> <div class="h-7 w-24 bg-bg-tertiary rounded mb-2"></div> <div class="h-3 w-32 bg-bg-tertiary rounded"></div></div>'),Fe=x('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"></div>'),Ge=x('<div class="text-xs text-text-muted mt-1"> </div>'),He=x('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"><div><div class="text-xs font-medium text-text-muted uppercase tracking-wider mb-2">Status</div> <div> </div> <!></div> <div class="rounded-xl border border-border-default bg-bg-secondary/50 p-4"><div class="text-xs font-medium text-text-muted uppercase tracking-wider mb-2">Uptime</div> <div class="text-2xl font-bold text-accent-cyan"> </div> <div class="text-xs text-text-muted mt-1"> </div></div> <div class="rounded-xl border border-border-default bg-bg-secondary/50 p-4"><div class="text-xs font-medium text-text-muted uppercase tracking-wider mb-2">Sessions</div> <div class="text-2xl font-bold text-accent-purple"> </div> <div class="text-xs text-text-muted mt-1"><!></div></div> <div class="rounded-xl border border-border-default bg-bg-secondary/50 p-4"><div class="text-xs font-medium text-text-muted uppercase tracking-wider mb-2">Models</div> <div class="text-2xl font-bold text-accent-amber"> </div> <div class="text-xs text-text-muted mt-1">Available providers</div></div></div>'),Ke=x('<div class="rounded-xl border border-border-default bg-bg-secondary/50 p-4 animate-pulse"><div class="flex items-center justify-between mb-3"><div class="h-3 w-20 bg-bg-tertiary rounded"></div> <div class="h-5 w-8 bg-bg-tertiary rounded"></div></div> <div class="h-3 w-40 bg-bg-tertiary rounded mb-2"></div> <div class="h-3 w-20 bg-bg-tertiary rounded"></div></div>'),Pe=x('<div class="grid grid-cols-1 md:grid-cols-3 gap-4"></div>'),Ue=x("<span> </span>"),qe=x('<span class="text-xs text-text-muted">n/a</span>'),Ee=x('<p class="text-xs text-text-muted font-mono"> </p>'),Qe=x('<div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div class="rounded-xl border border-border-default bg-bg-secondary/50 p-4"><div class="flex items-center justify-between mb-3"><div class="text-xs font-medium text-text-muted uppercase tracking-wider">Instances</div> <span class="text-lg font-bold text-accent-cyan"> </span></div> <p class="text-xs text-text-muted">Presence beacons from connected clients and nodes.</p> <a href="/instances" class="inline-block mt-2 text-xs text-accent-cyan hover:underline">View all →</a></div> <div class="rounded-xl border border-border-default bg-bg-secondary/50 p-4"><div class="flex items-center justify-between mb-3"><div class="text-xs font-medium text-text-muted uppercase tracking-wider">Cron</div> <!></div> <p class="text-xs text-text-muted"> </p> <a href="/cron" class="inline-block mt-2 text-xs text-accent-cyan hover:underline">Manage jobs →</a></div> <div class="rounded-xl border border-border-default bg-bg-secondary/50 p-4"><div class="flex items-center justify-between mb-3"><div class="text-xs font-medium text-text-muted uppercase tracking-wider">Auth</div> <span class="px-2 py-0.5 rounded text-xs font-medium bg-accent-purple/20 text-accent-purple"> </span></div> <!> <a href="/settings" class="inline-block mt-2 text-xs text-accent-cyan hover:underline">Configure →</a></div></div>'),Te=x('<div><div class="text-xs text-text-muted"> </div> <div class="text-sm text-text-secondary font-mono truncate"> </div></div>'),Je=x('<div class="rounded-xl border border-border-default bg-bg-secondary/50 p-4"><h2 class="text-sm font-semibold text-text-primary mb-3">Gateway Snapshot</h2> <div class="grid grid-cols-2 md:grid-cols-4 gap-4"></div></div>'),We=x(`<div class="h-full overflow-y-auto"><div class="max-w-6xl mx-auto p-4 md:p-6 space-y-6"><div class="flex items-center justify-between flex-wrap gap-3"><div><h1 class="text-2xl font-bold text-text-primary">Overview</h1> <p class="text-sm text-text-muted mt-1">Gateway status, entry points, and a fast health read.</p></div> <button class="px-3 py-2 rounded-lg text-sm border border-border-default hover:border-accent-cyan
               text-text-secondary hover:text-accent-cyan transition-all
               disabled:opacity-50 disabled:cursor-not-allowed"><!> Refresh</button></div> <!> <!> <!> <div class="rounded-xl border border-border-default bg-bg-secondary/50 p-4"><h2 class="text-sm font-semibold text-text-primary mb-3">Quick Actions</h2> <div class="grid grid-cols-2 md:grid-cols-4 gap-3"><a href="/" class="flex items-center gap-2 p-3 rounded-lg border border-border-default hover:border-accent-cyan
                          text-text-secondary hover:text-accent-cyan transition-all text-sm"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"></path></svg> Open Chat</a> <a href="/nodes" class="flex items-center gap-2 p-3 rounded-lg border border-border-default hover:border-accent-cyan
                               text-text-secondary hover:text-accent-cyan transition-all text-sm"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg> Node Fleet</a> <a href="/debug" class="flex items-center gap-2 p-3 rounded-lg border border-border-default hover:border-accent-cyan
                               text-text-secondary hover:text-accent-cyan transition-all text-sm"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> Debug</a> <a href="/logs" class="flex items-center gap-2 p-3 rounded-lg border border-border-default hover:border-accent-cyan
                              text-text-secondary hover:text-accent-cyan transition-all text-sm"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg> View Logs</a></div></div></div></div>`);function st(ne,ie){Ce(ie,!0);const g=Be(),H=ze();let m=D(null),X=D(0),I=D(null),B=D(null),le=D(null),Y=D(0),$=D(!1);L.on("hello",r=>{w(m,r,!0),w(X,Array.isArray(e(m)?.snapshot?.presence)?e(m).snapshot.presence.length:0,!0)}),je(()=>{g.state.status==="connected"&&Ae(()=>Z())});async function Z(){if(!(!L.connected||e($))){w($,!0);try{const[r,s,d,n]=await Promise.all([L.call("status",{}).catch(()=>null),L.call("health",{}).catch(()=>null),L.call("models.list",{}).catch(()=>null),L.call("cron.status",{}).catch(()=>null)]);w(B,r,!0),w(le,s,!0),w(Y,Array.isArray(d?.models)?d.models.length:0,!0),n&&w(I,{enabled:n.enabled??!1,nextRun:n.nextRunMs??null},!0)}catch(r){console.error("Failed to load overview:",r)}finally{w($,!1)}}}function ce(r){if(!r)return"n/a";const s=Math.floor(r/1e3);if(s<60)return`${s}s`;const d=Math.floor(s/60);if(d<60)return`${d}m ${s%60}s`;const n=Math.floor(d/60);return n<24?`${n}h ${d%60}m`:`${Math.floor(n/24)}d ${n%24}h`}function ve(r){if(r==null)return"n/a";const s=Date.now(),d=r-s;return d<0?"overdue":d<6e4?`in ${Math.floor(d/1e3)}s`:d<36e5?`in ${Math.floor(d/6e4)}m`:`in ${Math.floor(d/36e5)}h`}let ue=V(()=>e(m)?.snapshot?.uptimeMs),ee=V(()=>e(m)?.policy?.tickIntervalMs),te=V(()=>e(m)?.server?.version??g.state.serverVersion),xe=V(()=>e(m)?.protocol??g.state.protocol),be=V(()=>e(m)?.snapshot?.authMode??"unknown"),re=V(()=>e(m)?.server?.connId??g.state.connId);var K=We();Re("14qseeg",r=>{De(()=>{Ve.title="Overview — Cortex"})});var ae=a(K),P=a(ae),G=o(a(P),2),pe=a(G);{var me=r=>{var s=Le();i(r,s)};M(pe,r=>{e($)&&r(me)})}z(),t(G),t(P);var se=o(P,2);{var fe=r=>{var s=Fe();T(s,20,()=>Array(4),J,(d,n)=>{var b=Ne();i(d,b)}),t(s),i(r,s)},ge=r=>{var s=He(),d=a(s),n=o(a(d),2),b=a(n,!0);t(n);var O=o(n,2);{var C=c=>{var y=Ge(),Q=a(y);t(y),k(()=>v(Q,`v${e(te)??""} · protocol ${e(xe)??"?"??""}`)),i(c,y)};M(O,c=>{e(te)&&c(C)})}t(d);var p=o(d,2),f=o(a(p),2),j=a(f,!0);t(f);var R=o(f,2),h=a(R);t(R),t(p);var A=o(p,2),_=o(a(A),2),S=a(_,!0);t(_);var N=o(_,2),U=a(N);{var q=c=>{var y=oe();k(Q=>v(y,`Main: ${Q??""}`),[()=>H.mainKey.split(":").pop()]),i(c,y)},E=c=>{var y=oe("No main session");i(c,y)};M(U,c=>{H.mainKey?c(q):c(E,!1)})}t(N),t(A);var l=o(A,2),u=o(a(l),2),F=a(u,!0);t(u),z(2),t(l),t(s),k(c=>{W(d,1,`rounded-xl border border-border-default bg-bg-secondary/50 p-4
                    ${g.state.status==="connected"?"glow-green":""}`),W(n,1,`text-2xl font-bold
                      ${g.state.status==="connected"?"text-accent-green":"text-red-400"}`),v(b,g.state.status==="connected"?"Connected":"Disconnected"),v(j,c),v(h,`Tick: ${e(ee)?`${e(ee)}ms`:"n/a"}`),v(S,H.list.length),v(F,e(Y))},[()=>ce(e(ue))]),i(r,s)};M(se,r=>{e($)&&!e(B)?r(fe):r(ge,!1)})}var de=o(se,2);{var he=r=>{var s=Pe();T(s,20,()=>Array(3),J,(d,n)=>{var b=Ke();i(d,b)}),t(s),i(r,s)},_e=r=>{var s=Qe(),d=a(s),n=a(d),b=o(a(n),2),O=a(b,!0);t(b),t(n),z(4),t(d);var C=o(d,2),p=a(C),f=o(a(p),2);{var j=l=>{var u=Ue(),F=a(u,!0);t(u),k(()=>{W(u,1,`px-2 py-0.5 rounded text-xs font-medium
                          ${e(I).enabled?"bg-accent-green/20 text-accent-green":"bg-red-500/20 text-red-400"}`),v(F,e(I).enabled?"Enabled":"Disabled")}),i(l,u)},R=l=>{var u=qe();i(l,u)};M(f,l=>{e(I)?l(j):l(R,!1)})}t(p);var h=o(p,2),A=a(h);t(h),z(2),t(C);var _=o(C,2),S=a(_),N=o(a(S),2),U=a(N,!0);t(N),t(S);var q=o(S,2);{var E=l=>{var u=Ee(),F=a(u);t(u),k(c=>v(F,`ID: ${c??""}…`),[()=>e(re).substring(0,16)]),i(l,u)};M(q,l=>{e(re)&&l(E)})}z(2),t(_),t(s),k(l=>{v(O,e(X)),v(A,`Next run: ${l??""}`),v(U,e(be))},[()=>e(I)?ve(e(I).nextRun):"n/a"]),i(r,s)};M(de,r=>{e($)&&!e(B)?r(he):r(_e,!1)})}var ye=o(de,2);{var we=r=>{var s=Je(),d=o(a(s),2);T(d,21,()=>Object.entries(e(B)).filter(([n])=>typeof e(B)[n]!="object"),J,(n,b)=>{var O=V(()=>Ie(e(b),2));let C=()=>e(O)[0],p=()=>e(O)[1];var f=Te(),j=a(f),R=a(j,!0);t(j);var h=o(j,2),A=a(h,!0);t(h),t(f),k((_,S)=>{v(R,C()),Oe(h,"title",_),v(A,S)},[()=>String(p()),()=>String(p())]),i(n,f)}),t(d),t(s),i(r,s)};M(ye,r=>{e(B)&&r(we)})}z(2),t(ae),t(K),k(()=>G.disabled=e($)||g.state.status!=="connected"),Me("click",G,Z),i(ne,K),Se()}ke(["click"]);export{st as component};
