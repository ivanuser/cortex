const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DcOAMOlN.js","./DpBBTLWw.js","./qR_TM3YX.js","./Dg6LpIYP.js"])))=>i.map(i=>d[i]);
import{i as Wn,d as bt,b as f,f as k,s as K,a as de,c as Vt,t as wt,e as Lt,g as ft,r as qn}from"./B2A7gHtL.js";import{t as H,x as Yn,ak as Zn,a3 as zr,be as $r,O as Vn,K as Br,L as Ur,bc as Hr,b9 as Fr,N as jr,b1 as Gr,bf as Wr,bg as qr,P as rn,p as xt,c as kt,h,r as p,j as tt,f as x,n as Tt,g as i,d as O,i as J,s as ue,u as At,a as dr,F as Yr,k as Zr,e as Vr,$ as Kr}from"./qR_TM3YX.js";import{i as L,_ as wn}from"./DpBBTLWw.js";import{g as Kt,s as Se,r as Xr,e as ct,i as vt,b as Be,a as hn}from"./BhtVncI_.js";import{h as Qr}from"./CXQ1lKJR.js";import{b as pr}from"./nnazh41B.js";import{p as Qe}from"./CkAYskLX.js";import{g as yn}from"./9SZhwvK0.js";import{g as Xt,s as Kn}from"./CyMYiLoa.js";import{g as hr}from"./Be_uRYmX.js";import{C as Jr}from"./jyaC7jQ0.js";import{b as fn}from"./BYXRTvT-.js";import{s as gn}from"./tr5b7CMr.js";import{f as ea,g as ta}from"./DPrxUVm_.js";const fr=!0;function na(n,e,t=!1,a=!1,r=!1){var s=n,l="";H(()=>{var c=zr;if(l===(l=e()??"")){Yn&&Zn();return}if(c.nodes!==null&&($r(c.nodes.start,c.nodes.end),c.nodes=null),l!==""){if(Yn){Vn.data;for(var d=Zn(),u=d;d!==null&&(d.nodeType!==Br||d.data!=="");)u=d,d=Ur(d);if(d===null)throw Hr(),Fr;Wn(Vn,u),s=jr(d);return}var y=t?Wr:a?qr:void 0,b=Gr(t?"svg":a?"math":"template",y);b.innerHTML=l;var w=t||a?b:b.content;if(Wn(rn(w),w.lastChild),t||a)for(;rn(w);)s.before(rn(w));else s.before(w)}})}var ra=k("<button> </button>"),aa=Vt('<svg class="w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),sa=Vt('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>'),ia=k('<div class="px-3 py-2.5 rounded-lg border border-transparent"><div class="flex items-center justify-between mb-1.5"><div class="h-4 w-32 rounded bg-bg-tertiary skeleton-pulse"></div> <div class="h-3 w-8 rounded bg-bg-tertiary skeleton-pulse"></div></div> <div class="h-3 w-48 rounded bg-bg-tertiary skeleton-pulse" style="animation-delay: 0.1s"></div></div>'),oa=k('<div class="px-2 pb-2 space-y-1"></div>'),la=k('<div class="px-4 py-8 text-center text-text-muted text-sm"><!></div>'),ca=k('<p class="text-xs text-text-muted truncate mb-1"> </p>'),ua=k('<p class="text-xs text-text-muted/50 truncate mb-1 italic">No messages yet</p>'),da=k('<span class="inline-block text-[10px] px-1.5 py-0.5 rounded bg-accent-purple/15 text-purple-300/80 leading-none"> </span>'),pa=k("<span> </span>"),ha=k('<span class="inline-block text-[10px] px-1.5 py-0.5 rounded bg-bg-tertiary text-text-muted leading-none"> </span>'),fa=k('<button><div class="flex items-center justify-between mb-1"><div class="flex items-center gap-2 flex-1 min-w-0"><svg fill="currentColor" viewBox="0 0 24 24"><path></path></svg> <span> </span></div> <span class="text-xs text-text-muted flex-shrink-0 ml-2"> </span></div> <!> <div class="flex items-center gap-1.5 flex-wrap"><!> <!> <!></div></button>'),ga=k(`<div class="flex items-center gap-3 p-4 border-b border-border-default"><img src="/logo.png" alt="Cortex" class="w-10 h-10 rounded-lg"/> <div class="flex-1 min-w-0"><h1 class="text-lg font-semibold gradient-text tracking-wide">CORTEX</h1></div> <button class="p-2 rounded-lg hover:bg-bg-hover text-text-muted hover:text-text-primary transition-colors md:hidden min-h-11" aria-label="Close sidebar"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button> <button class="p-1 rounded hover:bg-bg-hover text-text-muted hover:text-text-primary transition-colors hidden md:block" aria-label="Collapse sidebar"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path></svg></button></div> <div class="px-3 py-2 border-b border-border-default"><!></div> <div class="p-3 space-y-2 border-b border-border-default"><div class="relative"><label for="session-search" class="sr-only">Search sessions</label> <input id="session-search" type="text" placeholder="Search sessions..." class="w-full pl-8 pr-3 py-2 text-sm rounded-lg glass border border-border-default bg-bg-tertiary
                 text-text-primary placeholder-text-muted
                 focus:outline-none focus:border-accent-cyan focus:glow-cyan
                 transition-all duration-200"/> <svg class="absolute left-2.5 top-2.5 w-4 h-4 text-text-muted" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></div> <div class="flex gap-1"></div></div> <div class="px-3 py-2 flex items-center justify-between"><span class="text-xs font-medium text-text-muted uppercase tracking-wider"> </span> <div class="flex gap-1"><button class="p-1 rounded hover:bg-bg-hover text-text-muted hover:text-accent-green transition-colors
                 disabled:opacity-50 disabled:cursor-not-allowed" title="Create new session" aria-label="Create new session"><!></button> <button class="p-1 rounded hover:bg-bg-hover text-text-muted hover:text-accent-cyan transition-colors" aria-label="Refresh sessions"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg></button></div></div> <div class="flex-1 overflow-y-auto"><!> <div class="px-2 pb-2 space-y-1"></div></div> <div class="p-3 border-t border-border-default"><a href="/settings" class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-text-secondary hover:bg-bg-hover hover:text-accent-purple transition-colors"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.066 2.573c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.573 1.066c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.066-2.573c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg> Settings</a></div>`,1),ma=k("<aside><!></aside>");function va(n,e){xt(e,!0);const t=yn(),a=Xt(),r=Kt(),s=hr();let l=Qe(e,"collapsed",15,!1),c=Qe(e,"mobileOpen",15,!1),d=ue(""),u=ue("all"),y=ue(!1),b=J(()=>{let T=t.list;if(i(d).trim()){const Z=i(d).toLowerCase();T=T.filter(I=>{const $=t.getSessionTitle(I).toLowerCase(),B=I.key.toLowerCase(),ae=I.lastMessage?.toLowerCase()||"";return $.includes(Z)||B.includes(Z)||ae.includes(Z)})}return i(u)!=="all"&&(T=T.filter(Z=>i(u)==="main"?Z.key===t.mainKey||Z.key.includes(":main"):i(u)==="isolated"?!Z.key.includes(":main")&&!Z.key.includes(":subagent:"):i(u)==="subagent"?Z.key.includes(":subagent:"):!0)),T});function w(T){t.setActiveSession(T),a.loadHistory(T),e.onMobileSessionSelect?.(T)}function N(T){if(!T)return"";const Z=typeof T=="string"?new Date(T):new Date(T),$=new Date().getTime()-Z.getTime();return $<6e4?"now":$<36e5?`${Math.floor($/6e4)}m`:$<864e5?`${Math.floor($/36e5)}h`:Z.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function M(T,Z){return T.length<=Z?T:T.slice(0,Z)+"â€¦"}function P(T){return T.key===t.mainKey||T.key.includes(":main")?"main":T.key.includes(":subagent:")?"subagent":"isolated"}function G(T){if(!T)return"bg-bg-tertiary text-text-muted";switch(T.toLowerCase()){case"discord":return"bg-purple-500/20 text-purple-300";case"telegram":return"bg-blue-500/20 text-blue-300";case"whatsapp":return"bg-green-500/20 text-green-300";case"webchat":return"bg-cyan-500/20 text-cyan-300";default:return"bg-bg-tertiary text-text-muted"}}function W(T){switch(T){case"main":return"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z";case"isolated":return"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z";case"subagent":return"M12 2l2 7h7l-5.5 4L17 20l-5-3.5L7 20l1.5-7L3 9h7l2-7z"}}async function ge(){if(!(!hn.connected||i(y))){O(y,!0);try{const T=`agent:main:isolated:${crypto.randomUUID()}`;await hn.chatSend(T,"Hello! This is a new isolated session."),await t.fetchSessions(),t.setActiveSession(T),a.loadHistory(T),s.success("Session Created","New isolated session created successfully")}catch(T){console.error("Failed to create session:",T),s.error("Failed to Create Session",T instanceof Error?T.message:"Unknown error")}finally{O(y,!1)}}}var pe=ma();let z;var re=h(pe);{var he=T=>{var Z=ga(),I=tt(Z),$=x(h(I),4),B=x($,2);p(I);var ae=x(I,2),ve=h(ae);Jr(ve,{}),p(ae);var me=x(ae,2),xe=h(me),Te=x(h(xe),2);Xr(Te),Tt(2),p(xe);var q=x(xe,2);ct(q,20,()=>[{key:"all",label:"All"},{key:"main",label:"Main"},{key:"isolated",label:"Isolated"},{key:"subagent",label:"Sub"}],vt,(ie,U)=>{var _e=ra(),Ee=h(_e,!0);p(_e),H(()=>{Se(_e,1,`flex-1 px-2 py-1 text-xs rounded transition-all
                  ${i(u)===U.key?"gradient-bg gradient-border glow-cyan text-text-primary":"border border-border-default hover:border-accent-cyan text-text-muted hover:text-text-secondary"}`),K(Ee,U.label)}),de("click",_e,()=>O(u,U.key,!0)),f(ie,_e)}),p(q),p(me);var j=x(me,2),ee=h(j),te=h(ee);p(ee);var A=x(ee,2),v=h(A),S=h(v);{var we=ie=>{var U=aa();f(ie,U)},m=ie=>{var U=sa();f(ie,U)};L(S,ie=>{i(y)?ie(we):ie(m,!1)})}p(v);var C=x(v,2),le=h(C);let X;p(C),p(A),p(j);var se=x(j,2),ye=h(se);{var je=ie=>{var U=oa();ct(U,20,()=>Array(5),vt,(_e,Ee)=>{var Ce=ia();f(_e,Ce)}),p(U),f(ie,U)},Me=ie=>{var U=la(),_e=h(U);{var Ee=V=>{var be=wt("No sessions match your search");f(V,be)},Ce=J(()=>i(d).trim()),Ge=V=>{var be=wt();H(()=>K(be,`No ${i(u)??""} sessions found`)),f(V,be)},ze=V=>{var be=wt("No sessions found");f(V,be)},at=V=>{var be=wt("Connect to see sessions");f(V,be)};L(_e,V=>{i(Ce)?V(Ee):i(u)!=="all"?V(Ge,1):r.state.status==="connected"?V(ze,2):V(at,!1)})}p(U),f(ie,U)};L(ye,ie=>{t.loading?ie(je):i(b).length===0&&ie(Me,1)})}var Ze=x(ye,2);ct(Ze,21,()=>i(b),ie=>ie.key,(ie,U)=>{const _e=J(()=>P(i(U)));var Ee=fa(),Ce=h(Ee),Ge=h(Ce),ze=h(Ge),at=h(ze);p(ze);var V=x(ze,2),be=h(V,!0);p(V),p(Ge);var We=x(Ge,2),_=h(We,!0);p(We),p(Ce);var R=x(Ce,2);{var Q=ce=>{var F=ca(),ne=h(F,!0);p(F),H(Ke=>K(ne,Ke),[()=>M(i(U).lastMessage,60)]),f(ce,F)},Ie=ce=>{var F=ua();f(ce,F)};L(R,ce=>{i(U).lastMessage?ce(Q):ce(Ie,!1)})}var Le=x(R,2),De=h(Le);{var Oe=ce=>{const F=J(()=>i(U).model.replace(/^(anthropic|openai|google|meta)\//i,"").split("/").pop()?.slice(0,20)??i(U).model);var ne=da(),Ke=h(ne,!0);p(ne),H(()=>K(Ke,i(F))),f(ce,ne)};L(De,ce=>{i(U).model&&ce(Oe)})}var ut=x(De,2);{var dt=ce=>{var F=pa(),ne=h(F,!0);p(F),H(Ke=>{Se(F,1,`inline-block text-[10px] px-1.5 py-0.5 rounded leading-none ${Ke??""}`),K(ne,i(U).channel)},[()=>G(i(U).channel)]),f(ce,F)};L(ut,ce=>{i(U).channel&&ce(dt)})}var _t=x(ut,2);{var Ve=ce=>{var F=ha(),ne=h(F);p(F),H(()=>K(ne,`${i(U).messageCount??""} msgs`)),f(ce,F)};L(_t,ce=>{i(U).messageCount&&ce(Ve)})}p(Le),p(Ee),H((ce,F,ne)=>{Se(Ee,1,`w-full text-left px-3 py-2.5 rounded-lg transition-all duration-200 group
              ${i(U).key===t.activeKey?"gradient-border gradient-bg glow-cyan":"hover:bg-bg-hover border border-transparent"}`),Se(ze,0,`w-3 h-3 flex-shrink-0 
                        ${i(_e)==="main"?"text-accent-purple":i(_e)==="subagent"?"text-accent-amber":"text-accent-cyan"}`),Be(at,"d",ce),Se(V,1,`text-sm font-medium truncate
                  ${i(U).key===t.activeKey?"text-accent-cyan":"text-text-primary"}`),K(be,F),K(_,ne)},[()=>W(i(_e)),()=>t.getSessionTitle(i(U)),()=>N(i(U).lastActivityAt??i(U).lastActivity)]),de("click",Ee,()=>w(i(U).key)),f(ie,Ee)}),p(Ze),p(se),Tt(2),H(()=>{K(te,`Sessions (${i(b).length??""})`),v.disabled=!r.state.status||r.state.status!=="connected"||i(y),C.disabled=t.loading,X=Se(le,0,"w-4 h-4",null,X,{"animate-spin":t.loading})}),de("click",$,()=>c(!1)),de("click",B,()=>l(!0)),pr(Te,()=>i(d),ie=>O(d,ie)),de("click",v,ge),de("click",C,()=>t.fetchSessions()),f(T,Z)};L(re,T=>{l()||T(he)})}p(pe),H(()=>z=Se(pe,1,`h-full flex flex-col border-r border-border-default bg-bg-secondary transition-all duration-300 overflow-hidden
         md:relative md:translate-x-0
         fixed left-0 top-0 z-50 w-72
         md:z-auto`,null,z,{"md:w-72":!l(),"md:w-0":l(),"-translate-x-full":!c(),"translate-x-0":c()})),f(n,pe),kt()}bt(["click"]);function Tn(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Et=Tn();function gr(n){Et=n}var $t={exec:()=>null};function oe(n,e=""){let t=typeof n=="string"?n:n.source;const a={replace:(r,s)=>{let l=typeof s=="string"?s:s.source;return l=l.replace(Ue.caret,"$1"),t=t.replace(r,l),a},getRegex:()=>new RegExp(t,e)};return a}var Ue={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},ba=/^(?:[ \t]*(?:\n|$))+/,xa=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,ka=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Ut=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,_a=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,An=/(?:[*+-]|\d{1,9}[.)])/,mr=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,vr=oe(mr).replace(/bull/g,An).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),wa=oe(mr).replace(/bull/g,An).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Sn=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ya=/^[^\n]+/,En=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Ta=oe(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",En).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Aa=oe(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,An).getRegex(),Qt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Cn=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Sa=oe("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Cn).replace("tag",Qt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),br=oe(Sn).replace("hr",Ut).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Qt).getRegex(),Ea=oe(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",br).getRegex(),Rn={blockquote:Ea,code:xa,def:Ta,fences:ka,heading:_a,hr:Ut,html:Sa,lheading:vr,list:Aa,newline:ba,paragraph:br,table:$t,text:ya},Xn=oe("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Ut).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Qt).getRegex(),Ca={...Rn,lheading:wa,table:Xn,paragraph:oe(Sn).replace("hr",Ut).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Xn).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Qt).getRegex()},Ra={...Rn,html:oe(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Cn).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:$t,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:oe(Sn).replace("hr",Ut).replace("heading",` *#{1,6} *[^
]`).replace("lheading",vr).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},La=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Ma=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,xr=/^( {2,}|\\)\n(?!\s*$)/,Ia=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Jt=/[\p{P}\p{S}]/u,Ln=/[\s\p{P}\p{S}]/u,kr=/[^\s\p{P}\p{S}]/u,Da=oe(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Ln).getRegex(),_r=/(?!~)[\p{P}\p{S}]/u,Oa=/(?!~)[\s\p{P}\p{S}]/u,Na=/(?:[^\s\p{P}\p{S}]|~)/u,Pa=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,wr=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,za=oe(wr,"u").replace(/punct/g,Jt).getRegex(),$a=oe(wr,"u").replace(/punct/g,_r).getRegex(),yr="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Ba=oe(yr,"gu").replace(/notPunctSpace/g,kr).replace(/punctSpace/g,Ln).replace(/punct/g,Jt).getRegex(),Ua=oe(yr,"gu").replace(/notPunctSpace/g,Na).replace(/punctSpace/g,Oa).replace(/punct/g,_r).getRegex(),Ha=oe("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,kr).replace(/punctSpace/g,Ln).replace(/punct/g,Jt).getRegex(),Fa=oe(/\\(punct)/,"gu").replace(/punct/g,Jt).getRegex(),ja=oe(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Ga=oe(Cn).replace("(?:-->|$)","-->").getRegex(),Wa=oe("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Ga).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Yt=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,qa=oe(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Yt).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Tr=oe(/^!?\[(label)\]\[(ref)\]/).replace("label",Yt).replace("ref",En).getRegex(),Ar=oe(/^!?\[(ref)\](?:\[\])?/).replace("ref",En).getRegex(),Ya=oe("reflink|nolink(?!\\()","g").replace("reflink",Tr).replace("nolink",Ar).getRegex(),Mn={_backpedal:$t,anyPunctuation:Fa,autolink:ja,blockSkip:Pa,br:xr,code:Ma,del:$t,emStrongLDelim:za,emStrongRDelimAst:Ba,emStrongRDelimUnd:Ha,escape:La,link:qa,nolink:Ar,punctuation:Da,reflink:Tr,reflinkSearch:Ya,tag:Wa,text:Ia,url:$t},Za={...Mn,link:oe(/^!?\[(label)\]\((.*?)\)/).replace("label",Yt).getRegex(),reflink:oe(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Yt).getRegex()},mn={...Mn,emStrongRDelimAst:Ua,emStrongLDelim:$a,url:oe(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Va={...mn,br:oe(xr).replace("{2,}","*").getRegex(),text:oe(mn.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Ft={normal:Rn,gfm:Ca,pedantic:Ra},Mt={normal:Mn,gfm:mn,breaks:Va,pedantic:Za},Ka={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Qn=n=>Ka[n];function ot(n,e){if(e){if(Ue.escapeTest.test(n))return n.replace(Ue.escapeReplace,Qn)}else if(Ue.escapeTestNoEncode.test(n))return n.replace(Ue.escapeReplaceNoEncode,Qn);return n}function Jn(n){try{n=encodeURI(n).replace(Ue.percentDecode,"%")}catch{return null}return n}function er(n,e){const t=n.replace(Ue.findPipe,(s,l,c)=>{let d=!1,u=l;for(;--u>=0&&c[u]==="\\";)d=!d;return d?"|":" |"}),a=t.split(Ue.splitPipe);let r=0;if(a[0].trim()||a.shift(),a.length>0&&!a.at(-1)?.trim()&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;r<a.length;r++)a[r]=a[r].trim().replace(Ue.slashPipe,"|");return a}function It(n,e,t){const a=n.length;if(a===0)return"";let r=0;for(;r<a&&n.charAt(a-r-1)===e;)r++;return n.slice(0,a-r)}function Xa(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let a=0;a<n.length;a++)if(n[a]==="\\")a++;else if(n[a]===e[0])t++;else if(n[a]===e[1]&&(t--,t<0))return a;return t>0?-2:-1}function tr(n,e,t,a,r){const s=e.href,l=e.title||null,c=n[1].replace(r.other.outputLinkReplace,"$1");a.state.inLink=!0;const d={type:n[0].charAt(0)==="!"?"image":"link",raw:t,href:s,title:l,text:c,tokens:a.inlineTokens(c)};return a.state.inLink=!1,d}function Qa(n,e,t){const a=n.match(t.other.indentCodeCompensation);if(a===null)return e;const r=a[1];return e.split(`
`).map(s=>{const l=s.match(t.other.beginningSpace);if(l===null)return s;const[c]=l;return c.length>=r.length?s.slice(r.length):s}).join(`
`)}var Zt=class{options;rules;lexer;constructor(n){this.options=n||Et}space(n){const e=this.rules.block.newline.exec(n);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(n){const e=this.rules.block.code.exec(n);if(e){const t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:It(t,`
`)}}}fences(n){const e=this.rules.block.fences.exec(n);if(e){const t=e[0],a=Qa(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(n){const e=this.rules.block.heading.exec(n);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){const a=It(t,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(t=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(n){const e=this.rules.block.hr.exec(n);if(e)return{type:"hr",raw:It(e[0],`
`)}}blockquote(n){const e=this.rules.block.blockquote.exec(n);if(e){let t=It(e[0],`
`).split(`
`),a="",r="";const s=[];for(;t.length>0;){let l=!1;const c=[];let d;for(d=0;d<t.length;d++)if(this.rules.other.blockquoteStart.test(t[d]))c.push(t[d]),l=!0;else if(!l)c.push(t[d]);else break;t=t.slice(d);const u=c.join(`
`),y=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${u}`:u,r=r?`${r}
${y}`:y;const b=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(y,s,!0),this.lexer.state.top=b,t.length===0)break;const w=s.at(-1);if(w?.type==="code")break;if(w?.type==="blockquote"){const N=w,M=N.raw+`
`+t.join(`
`),P=this.blockquote(M);s[s.length-1]=P,a=a.substring(0,a.length-N.raw.length)+P.raw,r=r.substring(0,r.length-N.text.length)+P.text;break}else if(w?.type==="list"){const N=w,M=N.raw+`
`+t.join(`
`),P=this.list(M);s[s.length-1]=P,a=a.substring(0,a.length-w.raw.length)+P.raw,r=r.substring(0,r.length-N.raw.length)+P.raw,t=M.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:s,text:r}}}list(n){let e=this.rules.block.list.exec(n);if(e){let t=e[1].trim();const a=t.length>1,r={type:"list",raw:"",ordered:a,start:a?+t.slice(0,-1):"",loose:!1,items:[]};t=a?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=a?t:"[*+-]");const s=this.rules.other.listItemRegex(t);let l=!1;for(;n;){let d=!1,u="",y="";if(!(e=s.exec(n))||this.rules.block.hr.test(n))break;u=e[0],n=n.substring(u.length);let b=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,W=>" ".repeat(3*W.length)),w=n.split(`
`,1)[0],N=!b.trim(),M=0;if(this.options.pedantic?(M=2,y=b.trimStart()):N?M=e[1].length+1:(M=e[2].search(this.rules.other.nonSpaceChar),M=M>4?1:M,y=b.slice(M),M+=e[1].length),N&&this.rules.other.blankLine.test(w)&&(u+=w+`
`,n=n.substring(w.length+1),d=!0),!d){const W=this.rules.other.nextBulletRegex(M),ge=this.rules.other.hrRegex(M),pe=this.rules.other.fencesBeginRegex(M),z=this.rules.other.headingBeginRegex(M),re=this.rules.other.htmlBeginRegex(M);for(;n;){const he=n.split(`
`,1)[0];let T;if(w=he,this.options.pedantic?(w=w.replace(this.rules.other.listReplaceNesting,"  "),T=w):T=w.replace(this.rules.other.tabCharGlobal,"    "),pe.test(w)||z.test(w)||re.test(w)||W.test(w)||ge.test(w))break;if(T.search(this.rules.other.nonSpaceChar)>=M||!w.trim())y+=`
`+T.slice(M);else{if(N||b.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||pe.test(b)||z.test(b)||ge.test(b))break;y+=`
`+w}!N&&!w.trim()&&(N=!0),u+=he+`
`,n=n.substring(he.length+1),b=T.slice(M)}}r.loose||(l?r.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(l=!0));let P=null,G;this.options.gfm&&(P=this.rules.other.listIsTask.exec(y),P&&(G=P[0]!=="[ ] ",y=y.replace(this.rules.other.listReplaceTask,""))),r.items.push({type:"list_item",raw:u,task:!!P,checked:G,loose:!1,text:y,tokens:[]}),r.raw+=u}const c=r.items.at(-1);if(c)c.raw=c.raw.trimEnd(),c.text=c.text.trimEnd();else return;r.raw=r.raw.trimEnd();for(let d=0;d<r.items.length;d++)if(this.lexer.state.top=!1,r.items[d].tokens=this.lexer.blockTokens(r.items[d].text,[]),!r.loose){const u=r.items[d].tokens.filter(b=>b.type==="space"),y=u.length>0&&u.some(b=>this.rules.other.anyLine.test(b.raw));r.loose=y}if(r.loose)for(let d=0;d<r.items.length;d++)r.items[d].loose=!0;return r}}html(n){const e=this.rules.block.html.exec(n);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(n){const e=this.rules.block.def.exec(n);if(e){const t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:a,title:r}}}table(n){const e=this.rules.block.table.exec(n);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;const t=er(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),r=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===a.length){for(const l of a)this.rules.other.tableAlignRight.test(l)?s.align.push("right"):this.rules.other.tableAlignCenter.test(l)?s.align.push("center"):this.rules.other.tableAlignLeft.test(l)?s.align.push("left"):s.align.push(null);for(let l=0;l<t.length;l++)s.header.push({text:t[l],tokens:this.lexer.inline(t[l]),header:!0,align:s.align[l]});for(const l of r)s.rows.push(er(l,s.header.length).map((c,d)=>({text:c,tokens:this.lexer.inline(c),header:!1,align:s.align[d]})));return s}}lheading(n){const e=this.rules.block.lheading.exec(n);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(n){const e=this.rules.block.paragraph.exec(n);if(e){const t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(n){const e=this.rules.block.text.exec(n);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(n){const e=this.rules.inline.escape.exec(n);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(n){const e=this.rules.inline.tag.exec(n);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(n){const e=this.rules.inline.link.exec(n);if(e){const t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;const s=It(t.slice(0,-1),"\\");if((t.length-s.length)%2===0)return}else{const s=Xa(e[2],"()");if(s===-2)return;if(s>-1){const c=(e[0].indexOf("!")===0?5:4)+e[1].length+s;e[2]=e[2].substring(0,s),e[0]=e[0].substring(0,c).trim(),e[3]=""}}let a=e[2],r="";if(this.options.pedantic){const s=this.rules.other.pedanticHrefTitle.exec(a);s&&(a=s[1],r=s[3])}else r=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?a=a.slice(1):a=a.slice(1,-1)),tr(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(n,e){let t;if((t=this.rules.inline.reflink.exec(n))||(t=this.rules.inline.nolink.exec(n))){const a=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),r=e[a.toLowerCase()];if(!r){const s=t[0].charAt(0);return{type:"text",raw:s,text:s}}return tr(t,r,t[0],this.lexer,this.rules)}}emStrong(n,e,t=""){let a=this.rules.inline.emStrongLDelim.exec(n);if(!a||a[3]&&t.match(this.rules.other.unicodeAlphaNumeric))return;if(!(a[1]||a[2]||"")||!t||this.rules.inline.punctuation.exec(t)){const s=[...a[0]].length-1;let l,c,d=s,u=0;const y=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(y.lastIndex=0,e=e.slice(-1*n.length+s);(a=y.exec(e))!=null;){if(l=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!l)continue;if(c=[...l].length,a[3]||a[4]){d+=c;continue}else if((a[5]||a[6])&&s%3&&!((s+c)%3)){u+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d+u);const b=[...a[0]][0].length,w=n.slice(0,s+a.index+b+c);if(Math.min(s,c)%2){const M=w.slice(1,-1);return{type:"em",raw:w,text:M,tokens:this.lexer.inlineTokens(M)}}const N=w.slice(2,-2);return{type:"strong",raw:w,text:N,tokens:this.lexer.inlineTokens(N)}}}}codespan(n){const e=this.rules.inline.code.exec(n);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," ");const a=this.rules.other.nonSpaceChar.test(t),r=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return a&&r&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(n){const e=this.rules.inline.br.exec(n);if(e)return{type:"br",raw:e[0]}}del(n){const e=this.rules.inline.del.exec(n);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(n){const e=this.rules.inline.autolink.exec(n);if(e){let t,a;return e[2]==="@"?(t=e[1],a="mailto:"+t):(t=e[1],a=t),{type:"link",raw:e[0],text:t,href:a,tokens:[{type:"text",raw:t,text:t}]}}}url(n){let e;if(e=this.rules.inline.url.exec(n)){let t,a;if(e[2]==="@")t=e[0],a="mailto:"+t;else{let r;do r=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(r!==e[0]);t=e[0],e[1]==="www."?a="http://"+e[0]:a=e[0]}return{type:"link",raw:e[0],text:t,href:a,tokens:[{type:"text",raw:t,text:t}]}}}inlineText(n){const e=this.rules.inline.text.exec(n);if(e){const t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},gt=class vn{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Et,this.options.tokenizer=this.options.tokenizer||new Zt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:Ue,block:Ft.normal,inline:Mt.normal};this.options.pedantic?(t.block=Ft.pedantic,t.inline=Mt.pedantic):this.options.gfm&&(t.block=Ft.gfm,this.options.breaks?t.inline=Mt.breaks:t.inline=Mt.gfm),this.tokenizer.rules=t}static get rules(){return{block:Ft,inline:Mt}}static lex(e,t){return new vn(t).lex(e)}static lexInline(e,t){return new vn(t).inlineTokens(e)}lex(e){e=e.replace(Ue.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const a=this.inlineQueue[t];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],a=!1){for(this.options.pedantic&&(e=e.replace(Ue.tabCharGlobal,"    ").replace(Ue.spaceLine,""));e;){let r;if(this.options.extensions?.block?.some(l=>(r=l.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))continue;if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length);const l=t.at(-1);r.raw.length===1&&l!==void 0?l.raw+=`
`:t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length);const l=t.at(-1);l?.type==="paragraph"||l?.type==="text"?(l.raw+=`
`+r.raw,l.text+=`
`+r.text,this.inlineQueue.at(-1).src=l.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length);const l=t.at(-1);l?.type==="paragraph"||l?.type==="text"?(l.raw+=`
`+r.raw,l.text+=`
`+r.raw,this.inlineQueue.at(-1).src=l.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}let s=e;if(this.options.extensions?.startBlock){let l=1/0;const c=e.slice(1);let d;this.options.extensions.startBlock.forEach(u=>{d=u.call({lexer:this},c),typeof d=="number"&&d>=0&&(l=Math.min(l,d))}),l<1/0&&l>=0&&(s=e.substring(0,l+1))}if(this.state.top&&(r=this.tokenizer.paragraph(s))){const l=t.at(-1);a&&l?.type==="paragraph"?(l.raw+=`
`+r.raw,l.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):t.push(r),a=s.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length);const l=t.at(-1);l?.type==="text"?(l.raw+=`
`+r.raw,l.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):t.push(r);continue}if(e){const l="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let a=e,r=null;if(this.tokens.links){const c=Object.keys(this.tokens.links);if(c.length>0)for(;(r=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)c.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(r=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,r.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(r=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)a=a.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let s=!1,l="";for(;e;){s||(l=""),s=!1;let c;if(this.options.extensions?.inline?.some(u=>(c=u.call({lexer:this},e,t))?(e=e.substring(c.raw.length),t.push(c),!0):!1))continue;if(c=this.tokenizer.escape(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.tag(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.link(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(c.raw.length);const u=t.at(-1);c.type==="text"&&u?.type==="text"?(u.raw+=c.raw,u.text+=c.text):t.push(c);continue}if(c=this.tokenizer.emStrong(e,a,l)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.codespan(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.br(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.del(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.autolink(e)){e=e.substring(c.raw.length),t.push(c);continue}if(!this.state.inLink&&(c=this.tokenizer.url(e))){e=e.substring(c.raw.length),t.push(c);continue}let d=e;if(this.options.extensions?.startInline){let u=1/0;const y=e.slice(1);let b;this.options.extensions.startInline.forEach(w=>{b=w.call({lexer:this},y),typeof b=="number"&&b>=0&&(u=Math.min(u,b))}),u<1/0&&u>=0&&(d=e.substring(0,u+1))}if(c=this.tokenizer.inlineText(d)){e=e.substring(c.raw.length),c.raw.slice(-1)!=="_"&&(l=c.raw.slice(-1)),s=!0;const u=t.at(-1);u?.type==="text"?(u.raw+=c.raw,u.text+=c.text):t.push(c);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return t}},Bt=class{options;parser;constructor(n){this.options=n||Et}space(n){return""}code({text:n,lang:e,escaped:t}){const a=(e||"").match(Ue.notSpaceStart)?.[0],r=n.replace(Ue.endingNewline,"")+`
`;return a?'<pre><code class="language-'+ot(a)+'">'+(t?r:ot(r,!0))+`</code></pre>
`:"<pre><code>"+(t?r:ot(r,!0))+`</code></pre>
`}blockquote({tokens:n}){return`<blockquote>
${this.parser.parse(n)}</blockquote>
`}html({text:n}){return n}heading({tokens:n,depth:e}){return`<h${e}>${this.parser.parseInline(n)}</h${e}>
`}hr(n){return`<hr>
`}list(n){const e=n.ordered,t=n.start;let a="";for(let l=0;l<n.items.length;l++){const c=n.items[l];a+=this.listitem(c)}const r=e?"ol":"ul",s=e&&t!==1?' start="'+t+'"':"";return"<"+r+s+`>
`+a+"</"+r+`>
`}listitem(n){let e="";if(n.task){const t=this.checkbox({checked:!!n.checked});n.loose?n.tokens[0]?.type==="paragraph"?(n.tokens[0].text=t+" "+n.tokens[0].text,n.tokens[0].tokens&&n.tokens[0].tokens.length>0&&n.tokens[0].tokens[0].type==="text"&&(n.tokens[0].tokens[0].text=t+" "+ot(n.tokens[0].tokens[0].text),n.tokens[0].tokens[0].escaped=!0)):n.tokens.unshift({type:"text",raw:t+" ",text:t+" ",escaped:!0}):e+=t+" "}return e+=this.parser.parse(n.tokens,!!n.loose),`<li>${e}</li>
`}checkbox({checked:n}){return"<input "+(n?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:n}){return`<p>${this.parser.parseInline(n)}</p>
`}table(n){let e="",t="";for(let r=0;r<n.header.length;r++)t+=this.tablecell(n.header[r]);e+=this.tablerow({text:t});let a="";for(let r=0;r<n.rows.length;r++){const s=n.rows[r];t="";for(let l=0;l<s.length;l++)t+=this.tablecell(s[l]);a+=this.tablerow({text:t})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:n}){return`<tr>
${n}</tr>
`}tablecell(n){const e=this.parser.parseInline(n.tokens),t=n.header?"th":"td";return(n.align?`<${t} align="${n.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:n}){return`<strong>${this.parser.parseInline(n)}</strong>`}em({tokens:n}){return`<em>${this.parser.parseInline(n)}</em>`}codespan({text:n}){return`<code>${ot(n,!0)}</code>`}br(n){return"<br>"}del({tokens:n}){return`<del>${this.parser.parseInline(n)}</del>`}link({href:n,title:e,tokens:t}){const a=this.parser.parseInline(t),r=Jn(n);if(r===null)return a;n=r;let s='<a href="'+n+'"';return e&&(s+=' title="'+ot(e)+'"'),s+=">"+a+"</a>",s}image({href:n,title:e,text:t,tokens:a}){a&&(t=this.parser.parseInline(a,this.parser.textRenderer));const r=Jn(n);if(r===null)return ot(t);n=r;let s=`<img src="${n}" alt="${t}"`;return e&&(s+=` title="${ot(e)}"`),s+=">",s}text(n){return"tokens"in n&&n.tokens?this.parser.parseInline(n.tokens):"escaped"in n&&n.escaped?n.text:ot(n.text)}},In=class{strong({text:n}){return n}em({text:n}){return n}codespan({text:n}){return n}del({text:n}){return n}html({text:n}){return n}text({text:n}){return n}link({text:n}){return""+n}image({text:n}){return""+n}br(){return""}},mt=class bn{options;renderer;textRenderer;constructor(e){this.options=e||Et,this.options.renderer=this.options.renderer||new Bt,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new In}static parse(e,t){return new bn(t).parse(e)}static parseInline(e,t){return new bn(t).parseInline(e)}parse(e,t=!0){let a="";for(let r=0;r<e.length;r++){const s=e[r];if(this.options.extensions?.renderers?.[s.type]){const c=s,d=this.options.extensions.renderers[c.type].call({parser:this},c);if(d!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){a+=d||"";continue}}const l=s;switch(l.type){case"space":{a+=this.renderer.space(l);continue}case"hr":{a+=this.renderer.hr(l);continue}case"heading":{a+=this.renderer.heading(l);continue}case"code":{a+=this.renderer.code(l);continue}case"table":{a+=this.renderer.table(l);continue}case"blockquote":{a+=this.renderer.blockquote(l);continue}case"list":{a+=this.renderer.list(l);continue}case"html":{a+=this.renderer.html(l);continue}case"paragraph":{a+=this.renderer.paragraph(l);continue}case"text":{let c=l,d=this.renderer.text(c);for(;r+1<e.length&&e[r+1].type==="text";)c=e[++r],d+=`
`+this.renderer.text(c);t?a+=this.renderer.paragraph({type:"paragraph",raw:d,text:d,tokens:[{type:"text",raw:d,text:d,escaped:!0}]}):a+=d;continue}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return a}parseInline(e,t=this.renderer){let a="";for(let r=0;r<e.length;r++){const s=e[r];if(this.options.extensions?.renderers?.[s.type]){const c=this.options.extensions.renderers[s.type].call({parser:this},s);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){a+=c||"";continue}}const l=s;switch(l.type){case"escape":{a+=t.text(l);break}case"html":{a+=t.html(l);break}case"link":{a+=t.link(l);break}case"image":{a+=t.image(l);break}case"strong":{a+=t.strong(l);break}case"em":{a+=t.em(l);break}case"codespan":{a+=t.codespan(l);break}case"br":{a+=t.br(l);break}case"del":{a+=t.del(l);break}case"text":{a+=t.text(l);break}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return a}},Wt=class{options;block;constructor(n){this.options=n||Et}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(n){return n}postprocess(n){return n}processAllTokens(n){return n}provideLexer(){return this.block?gt.lex:gt.lexInline}provideParser(){return this.block?mt.parse:mt.parseInline}},Sr=class{defaults=Tn();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=mt;Renderer=Bt;TextRenderer=In;Lexer=gt;Tokenizer=Zt;Hooks=Wt;constructor(...n){this.use(...n)}walkTokens(n,e){let t=[];for(const a of n)switch(t=t.concat(e.call(this,a)),a.type){case"table":{const r=a;for(const s of r.header)t=t.concat(this.walkTokens(s.tokens,e));for(const s of r.rows)for(const l of s)t=t.concat(this.walkTokens(l.tokens,e));break}case"list":{const r=a;t=t.concat(this.walkTokens(r.items,e));break}default:{const r=a;this.defaults.extensions?.childTokens?.[r.type]?this.defaults.extensions.childTokens[r.type].forEach(s=>{const l=r[s].flat(1/0);t=t.concat(this.walkTokens(l,e))}):r.tokens&&(t=t.concat(this.walkTokens(r.tokens,e)))}}return t}use(...n){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(t=>{const a={...t};if(a.async=this.defaults.async||a.async||!1,t.extensions&&(t.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){const s=e.renderers[r.name];s?e.renderers[r.name]=function(...l){let c=r.renderer.apply(this,l);return c===!1&&(c=s.apply(this,l)),c}:e.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const s=e[r.level];s?s.unshift(r.tokenizer):e[r.level]=[r.tokenizer],r.start&&(r.level==="block"?e.startBlock?e.startBlock.push(r.start):e.startBlock=[r.start]:r.level==="inline"&&(e.startInline?e.startInline.push(r.start):e.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(e.childTokens[r.name]=r.childTokens)}),a.extensions=e),t.renderer){const r=this.defaults.renderer||new Bt(this.defaults);for(const s in t.renderer){if(!(s in r))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;const l=s,c=t.renderer[l],d=r[l];r[l]=(...u)=>{let y=c.apply(r,u);return y===!1&&(y=d.apply(r,u)),y||""}}a.renderer=r}if(t.tokenizer){const r=this.defaults.tokenizer||new Zt(this.defaults);for(const s in t.tokenizer){if(!(s in r))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;const l=s,c=t.tokenizer[l],d=r[l];r[l]=(...u)=>{let y=c.apply(r,u);return y===!1&&(y=d.apply(r,u)),y}}a.tokenizer=r}if(t.hooks){const r=this.defaults.hooks||new Wt;for(const s in t.hooks){if(!(s in r))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;const l=s,c=t.hooks[l],d=r[l];Wt.passThroughHooks.has(s)?r[l]=u=>{if(this.defaults.async)return Promise.resolve(c.call(r,u)).then(b=>d.call(r,b));const y=c.call(r,u);return d.call(r,y)}:r[l]=(...u)=>{let y=c.apply(r,u);return y===!1&&(y=d.apply(r,u)),y}}a.hooks=r}if(t.walkTokens){const r=this.defaults.walkTokens,s=t.walkTokens;a.walkTokens=function(l){let c=[];return c.push(s.call(this,l)),r&&(c=c.concat(r.call(this,l))),c}}this.defaults={...this.defaults,...a}}),this}setOptions(n){return this.defaults={...this.defaults,...n},this}lexer(n,e){return gt.lex(n,e??this.defaults)}parser(n,e){return mt.parse(n,e??this.defaults)}parseMarkdown(n){return(t,a)=>{const r={...a},s={...this.defaults,...r},l=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&r.async===!1)return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));s.hooks&&(s.hooks.options=s,s.hooks.block=n);const c=s.hooks?s.hooks.provideLexer():n?gt.lex:gt.lexInline,d=s.hooks?s.hooks.provideParser():n?mt.parse:mt.parseInline;if(s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(t):t).then(u=>c(u,s)).then(u=>s.hooks?s.hooks.processAllTokens(u):u).then(u=>s.walkTokens?Promise.all(this.walkTokens(u,s.walkTokens)).then(()=>u):u).then(u=>d(u,s)).then(u=>s.hooks?s.hooks.postprocess(u):u).catch(l);try{s.hooks&&(t=s.hooks.preprocess(t));let u=c(t,s);s.hooks&&(u=s.hooks.processAllTokens(u)),s.walkTokens&&this.walkTokens(u,s.walkTokens);let y=d(u,s);return s.hooks&&(y=s.hooks.postprocess(y)),y}catch(u){return l(u)}}}onError(n,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,n){const a="<p>An error occurred:</p><pre>"+ot(t.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(t);throw t}}},St=new Sr;function fe(n,e){return St.parse(n,e)}fe.options=fe.setOptions=function(n){return St.setOptions(n),fe.defaults=St.defaults,gr(fe.defaults),fe};fe.getDefaults=Tn;fe.defaults=Et;fe.use=function(...n){return St.use(...n),fe.defaults=St.defaults,gr(fe.defaults),fe};fe.walkTokens=function(n,e){return St.walkTokens(n,e)};fe.parseInline=St.parseInline;fe.Parser=mt;fe.parser=mt.parse;fe.Renderer=Bt;fe.TextRenderer=In;fe.Lexer=gt;fe.lexer=gt.lex;fe.Tokenizer=Zt;fe.Hooks=Wt;fe.parse=fe;fe.options;fe.setOptions;fe.use;fe.walkTokens;fe.parseInline;mt.parse;gt.lex;const{entries:Er,setPrototypeOf:nr,isFrozen:Ja,getPrototypeOf:es,getOwnPropertyDescriptor:ts}=Object;let{freeze:He,seal:nt,create:xn}=Object,{apply:kn,construct:_n}=typeof Reflect<"u"&&Reflect;He||(He=function(e){return e});nt||(nt=function(e){return e});kn||(kn=function(e,t){for(var a=arguments.length,r=new Array(a>2?a-2:0),s=2;s<a;s++)r[s-2]=arguments[s];return e.apply(t,r)});_n||(_n=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];return new e(...a)});const jt=Fe(Array.prototype.forEach),ns=Fe(Array.prototype.lastIndexOf),rr=Fe(Array.prototype.pop),Dt=Fe(Array.prototype.push),rs=Fe(Array.prototype.splice),qt=Fe(String.prototype.toLowerCase),an=Fe(String.prototype.toString),sn=Fe(String.prototype.match),Ot=Fe(String.prototype.replace),as=Fe(String.prototype.indexOf),ss=Fe(String.prototype.trim),rt=Fe(Object.prototype.hasOwnProperty),$e=Fe(RegExp.prototype.test),Nt=is(TypeError);function Fe(n){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,a=new Array(t>1?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];return kn(n,e,a)}}function is(n){return function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return _n(n,t)}}function Y(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:qt;nr&&nr(n,null);let a=e.length;for(;a--;){let r=e[a];if(typeof r=="string"){const s=t(r);s!==r&&(Ja(e)||(e[a]=s),r=s)}n[r]=!0}return n}function os(n){for(let e=0;e<n.length;e++)rt(n,e)||(n[e]=null);return n}function lt(n){const e=xn(null);for(const[t,a]of Er(n))rt(n,t)&&(Array.isArray(a)?e[t]=os(a):a&&typeof a=="object"&&a.constructor===Object?e[t]=lt(a):e[t]=a);return e}function Pt(n,e){for(;n!==null;){const a=ts(n,e);if(a){if(a.get)return Fe(a.get);if(typeof a.value=="function")return Fe(a.value)}n=es(n)}function t(){return null}return t}const ar=He(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),on=He(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ln=He(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ls=He(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),cn=He(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),cs=He(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),sr=He(["#text"]),ir=He(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),un=He(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),or=He(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Gt=He(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),us=nt(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ds=nt(/<%[\w\W]*|[\w\W]*%>/gm),ps=nt(/\$\{[\w\W]*/gm),hs=nt(/^data-[\-\w.\u00B7-\uFFFF]+$/),fs=nt(/^aria-[\-\w]+$/),Cr=nt(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),gs=nt(/^(?:\w+script|data):/i),ms=nt(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Rr=nt(/^html$/i),vs=nt(/^[a-z][.\w]*(-[.\w]+)+$/i);var lr=Object.freeze({__proto__:null,ARIA_ATTR:fs,ATTR_WHITESPACE:ms,CUSTOM_ELEMENT:vs,DATA_ATTR:hs,DOCTYPE_NAME:Rr,ERB_EXPR:ds,IS_ALLOWED_URI:Cr,IS_SCRIPT_OR_DATA:gs,MUSTACHE_EXPR:us,TMPLIT_EXPR:ps});const zt={element:1,text:3,progressingInstruction:7,comment:8,document:9},bs=function(){return typeof window>"u"?null:window},xs=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let a=null;const r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(a=t.getAttribute(r));const s="dompurify"+(a?"#"+a:"");try{return e.createPolicy(s,{createHTML(l){return l},createScriptURL(l){return l}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},cr=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Lr(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bs();const e=D=>Lr(D);if(e.version="3.3.1",e.removed=[],!n||!n.document||n.document.nodeType!==zt.document||!n.Element)return e.isSupported=!1,e;let{document:t}=n;const a=t,r=a.currentScript,{DocumentFragment:s,HTMLTemplateElement:l,Node:c,Element:d,NodeFilter:u,NamedNodeMap:y=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:b,DOMParser:w,trustedTypes:N}=n,M=d.prototype,P=Pt(M,"cloneNode"),G=Pt(M,"remove"),W=Pt(M,"nextSibling"),ge=Pt(M,"childNodes"),pe=Pt(M,"parentNode");if(typeof l=="function"){const D=t.createElement("template");D.content&&D.content.ownerDocument&&(t=D.content.ownerDocument)}let z,re="";const{implementation:he,createNodeIterator:T,createDocumentFragment:Z,getElementsByTagName:I}=t,{importNode:$}=a;let B=cr();e.isSupported=typeof Er=="function"&&typeof pe=="function"&&he&&he.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ae,ERB_EXPR:ve,TMPLIT_EXPR:me,DATA_ATTR:xe,ARIA_ATTR:Te,IS_SCRIPT_OR_DATA:q,ATTR_WHITESPACE:j,CUSTOM_ELEMENT:ee}=lr;let{IS_ALLOWED_URI:te}=lr,A=null;const v=Y({},[...ar,...on,...ln,...cn,...sr]);let S=null;const we=Y({},[...ir,...un,...or,...Gt]);let m=Object.seal(xn(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),C=null,le=null;const X=Object.seal(xn(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let se=!0,ye=!0,je=!1,Me=!0,Ze=!1,ie=!0,U=!1,_e=!1,Ee=!1,Ce=!1,Ge=!1,ze=!1,at=!0,V=!1;const be="user-content-";let We=!0,_=!1,R={},Q=null;const Ie=Y({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Le=null;const De=Y({},["audio","video","img","source","image","track"]);let Oe=null;const ut=Y({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),dt="http://www.w3.org/1998/Math/MathML",_t="http://www.w3.org/2000/svg",Ve="http://www.w3.org/1999/xhtml";let ce=Ve,F=!1,ne=null;const Ke=Y({},[dt,_t,Ve],an);let Je=Y({},["mi","mo","mn","ms","mtext"]),Xe=Y({},["annotation-xml"]);const et=Y({},["title","style","font","a","script"]);let st=null;const Ir=["application/xhtml+xml","text/html"],Dr="text/html";let Re=null,Ct=null;const Or=t.createElement("form"),Dn=function(o){return o instanceof RegExp||o instanceof Function},en=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ct&&Ct===o)){if((!o||typeof o!="object")&&(o={}),o=lt(o),st=Ir.indexOf(o.PARSER_MEDIA_TYPE)===-1?Dr:o.PARSER_MEDIA_TYPE,Re=st==="application/xhtml+xml"?an:qt,A=rt(o,"ALLOWED_TAGS")?Y({},o.ALLOWED_TAGS,Re):v,S=rt(o,"ALLOWED_ATTR")?Y({},o.ALLOWED_ATTR,Re):we,ne=rt(o,"ALLOWED_NAMESPACES")?Y({},o.ALLOWED_NAMESPACES,an):Ke,Oe=rt(o,"ADD_URI_SAFE_ATTR")?Y(lt(ut),o.ADD_URI_SAFE_ATTR,Re):ut,Le=rt(o,"ADD_DATA_URI_TAGS")?Y(lt(De),o.ADD_DATA_URI_TAGS,Re):De,Q=rt(o,"FORBID_CONTENTS")?Y({},o.FORBID_CONTENTS,Re):Ie,C=rt(o,"FORBID_TAGS")?Y({},o.FORBID_TAGS,Re):lt({}),le=rt(o,"FORBID_ATTR")?Y({},o.FORBID_ATTR,Re):lt({}),R=rt(o,"USE_PROFILES")?o.USE_PROFILES:!1,se=o.ALLOW_ARIA_ATTR!==!1,ye=o.ALLOW_DATA_ATTR!==!1,je=o.ALLOW_UNKNOWN_PROTOCOLS||!1,Me=o.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ze=o.SAFE_FOR_TEMPLATES||!1,ie=o.SAFE_FOR_XML!==!1,U=o.WHOLE_DOCUMENT||!1,Ce=o.RETURN_DOM||!1,Ge=o.RETURN_DOM_FRAGMENT||!1,ze=o.RETURN_TRUSTED_TYPE||!1,Ee=o.FORCE_BODY||!1,at=o.SANITIZE_DOM!==!1,V=o.SANITIZE_NAMED_PROPS||!1,We=o.KEEP_CONTENT!==!1,_=o.IN_PLACE||!1,te=o.ALLOWED_URI_REGEXP||Cr,ce=o.NAMESPACE||Ve,Je=o.MATHML_TEXT_INTEGRATION_POINTS||Je,Xe=o.HTML_INTEGRATION_POINTS||Xe,m=o.CUSTOM_ELEMENT_HANDLING||{},o.CUSTOM_ELEMENT_HANDLING&&Dn(o.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(m.tagNameCheck=o.CUSTOM_ELEMENT_HANDLING.tagNameCheck),o.CUSTOM_ELEMENT_HANDLING&&Dn(o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(m.attributeNameCheck=o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),o.CUSTOM_ELEMENT_HANDLING&&typeof o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(m.allowCustomizedBuiltInElements=o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ze&&(ye=!1),Ge&&(Ce=!0),R&&(A=Y({},sr),S=[],R.html===!0&&(Y(A,ar),Y(S,ir)),R.svg===!0&&(Y(A,on),Y(S,un),Y(S,Gt)),R.svgFilters===!0&&(Y(A,ln),Y(S,un),Y(S,Gt)),R.mathMl===!0&&(Y(A,cn),Y(S,or),Y(S,Gt))),o.ADD_TAGS&&(typeof o.ADD_TAGS=="function"?X.tagCheck=o.ADD_TAGS:(A===v&&(A=lt(A)),Y(A,o.ADD_TAGS,Re))),o.ADD_ATTR&&(typeof o.ADD_ATTR=="function"?X.attributeCheck=o.ADD_ATTR:(S===we&&(S=lt(S)),Y(S,o.ADD_ATTR,Re))),o.ADD_URI_SAFE_ATTR&&Y(Oe,o.ADD_URI_SAFE_ATTR,Re),o.FORBID_CONTENTS&&(Q===Ie&&(Q=lt(Q)),Y(Q,o.FORBID_CONTENTS,Re)),o.ADD_FORBID_CONTENTS&&(Q===Ie&&(Q=lt(Q)),Y(Q,o.ADD_FORBID_CONTENTS,Re)),We&&(A["#text"]=!0),U&&Y(A,["html","head","body"]),A.table&&(Y(A,["tbody"]),delete C.tbody),o.TRUSTED_TYPES_POLICY){if(typeof o.TRUSTED_TYPES_POLICY.createHTML!="function")throw Nt('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof o.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Nt('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');z=o.TRUSTED_TYPES_POLICY,re=z.createHTML("")}else z===void 0&&(z=xs(N,r)),z!==null&&typeof re=="string"&&(re=z.createHTML(""));He&&He(o),Ct=o}},On=Y({},[...on,...ln,...ls]),Nn=Y({},[...cn,...cs]),Nr=function(o){let g=pe(o);(!g||!g.tagName)&&(g={namespaceURI:ce,tagName:"template"});const E=qt(o.tagName),ke=qt(g.tagName);return ne[o.namespaceURI]?o.namespaceURI===_t?g.namespaceURI===Ve?E==="svg":g.namespaceURI===dt?E==="svg"&&(ke==="annotation-xml"||Je[ke]):!!On[E]:o.namespaceURI===dt?g.namespaceURI===Ve?E==="math":g.namespaceURI===_t?E==="math"&&Xe[ke]:!!Nn[E]:o.namespaceURI===Ve?g.namespaceURI===_t&&!Xe[ke]||g.namespaceURI===dt&&!Je[ke]?!1:!Nn[E]&&(et[E]||!On[E]):!!(st==="application/xhtml+xml"&&ne[o.namespaceURI]):!1},it=function(o){Dt(e.removed,{element:o});try{pe(o).removeChild(o)}catch{G(o)}},yt=function(o,g){try{Dt(e.removed,{attribute:g.getAttributeNode(o),from:g})}catch{Dt(e.removed,{attribute:null,from:g})}if(g.removeAttribute(o),o==="is")if(Ce||Ge)try{it(g)}catch{}else try{g.setAttribute(o,"")}catch{}},Pn=function(o){let g=null,E=null;if(Ee)o="<remove></remove>"+o;else{const Ae=sn(o,/^[\r\n\t ]+/);E=Ae&&Ae[0]}st==="application/xhtml+xml"&&ce===Ve&&(o='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+o+"</body></html>");const ke=z?z.createHTML(o):o;if(ce===Ve)try{g=new w().parseFromString(ke,st)}catch{}if(!g||!g.documentElement){g=he.createDocument(ce,"template",null);try{g.documentElement.innerHTML=F?re:ke}catch{}}const Pe=g.body||g.documentElement;return o&&E&&Pe.insertBefore(t.createTextNode(E),Pe.childNodes[0]||null),ce===Ve?I.call(g,U?"html":"body")[0]:U?g.documentElement:Pe},zn=function(o){return T.call(o.ownerDocument||o,o,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},tn=function(o){return o instanceof b&&(typeof o.nodeName!="string"||typeof o.textContent!="string"||typeof o.removeChild!="function"||!(o.attributes instanceof y)||typeof o.removeAttribute!="function"||typeof o.setAttribute!="function"||typeof o.namespaceURI!="string"||typeof o.insertBefore!="function"||typeof o.hasChildNodes!="function")},$n=function(o){return typeof c=="function"&&o instanceof c};function pt(D,o,g){jt(D,E=>{E.call(e,o,g,Ct)})}const Bn=function(o){let g=null;if(pt(B.beforeSanitizeElements,o,null),tn(o))return it(o),!0;const E=Re(o.nodeName);if(pt(B.uponSanitizeElement,o,{tagName:E,allowedTags:A}),ie&&o.hasChildNodes()&&!$n(o.firstElementChild)&&$e(/<[/\w!]/g,o.innerHTML)&&$e(/<[/\w!]/g,o.textContent)||o.nodeType===zt.progressingInstruction||ie&&o.nodeType===zt.comment&&$e(/<[/\w]/g,o.data))return it(o),!0;if(!(X.tagCheck instanceof Function&&X.tagCheck(E))&&(!A[E]||C[E])){if(!C[E]&&Hn(E)&&(m.tagNameCheck instanceof RegExp&&$e(m.tagNameCheck,E)||m.tagNameCheck instanceof Function&&m.tagNameCheck(E)))return!1;if(We&&!Q[E]){const ke=pe(o)||o.parentNode,Pe=ge(o)||o.childNodes;if(Pe&&ke){const Ae=Pe.length;for(let qe=Ae-1;qe>=0;--qe){const ht=P(Pe[qe],!0);ht.__removalCount=(o.__removalCount||0)+1,ke.insertBefore(ht,W(o))}}}return it(o),!0}return o instanceof d&&!Nr(o)||(E==="noscript"||E==="noembed"||E==="noframes")&&$e(/<\/no(script|embed|frames)/i,o.innerHTML)?(it(o),!0):(Ze&&o.nodeType===zt.text&&(g=o.textContent,jt([ae,ve,me],ke=>{g=Ot(g,ke," ")}),o.textContent!==g&&(Dt(e.removed,{element:o.cloneNode()}),o.textContent=g)),pt(B.afterSanitizeElements,o,null),!1)},Un=function(o,g,E){if(at&&(g==="id"||g==="name")&&(E in t||E in Or))return!1;if(!(ye&&!le[g]&&$e(xe,g))){if(!(se&&$e(Te,g))){if(!(X.attributeCheck instanceof Function&&X.attributeCheck(g,o))){if(!S[g]||le[g]){if(!(Hn(o)&&(m.tagNameCheck instanceof RegExp&&$e(m.tagNameCheck,o)||m.tagNameCheck instanceof Function&&m.tagNameCheck(o))&&(m.attributeNameCheck instanceof RegExp&&$e(m.attributeNameCheck,g)||m.attributeNameCheck instanceof Function&&m.attributeNameCheck(g,o))||g==="is"&&m.allowCustomizedBuiltInElements&&(m.tagNameCheck instanceof RegExp&&$e(m.tagNameCheck,E)||m.tagNameCheck instanceof Function&&m.tagNameCheck(E))))return!1}else if(!Oe[g]){if(!$e(te,Ot(E,j,""))){if(!((g==="src"||g==="xlink:href"||g==="href")&&o!=="script"&&as(E,"data:")===0&&Le[o])){if(!(je&&!$e(q,Ot(E,j,"")))){if(E)return!1}}}}}}}return!0},Hn=function(o){return o!=="annotation-xml"&&sn(o,ee)},Fn=function(o){pt(B.beforeSanitizeAttributes,o,null);const{attributes:g}=o;if(!g||tn(o))return;const E={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:S,forceKeepAttr:void 0};let ke=g.length;for(;ke--;){const Pe=g[ke],{name:Ae,namespaceURI:qe,value:ht}=Pe,Rt=Re(Ae),nn=ht;let Ne=Ae==="value"?nn:ss(nn);if(E.attrName=Rt,E.attrValue=Ne,E.keepAttr=!0,E.forceKeepAttr=void 0,pt(B.uponSanitizeAttribute,o,E),Ne=E.attrValue,V&&(Rt==="id"||Rt==="name")&&(yt(Ae,o),Ne=be+Ne),ie&&$e(/((--!?|])>)|<\/(style|title|textarea)/i,Ne)){yt(Ae,o);continue}if(Rt==="attributename"&&sn(Ne,"href")){yt(Ae,o);continue}if(E.forceKeepAttr)continue;if(!E.keepAttr){yt(Ae,o);continue}if(!Me&&$e(/\/>/i,Ne)){yt(Ae,o);continue}Ze&&jt([ae,ve,me],Gn=>{Ne=Ot(Ne,Gn," ")});const jn=Re(o.nodeName);if(!Un(jn,Rt,Ne)){yt(Ae,o);continue}if(z&&typeof N=="object"&&typeof N.getAttributeType=="function"&&!qe)switch(N.getAttributeType(jn,Rt)){case"TrustedHTML":{Ne=z.createHTML(Ne);break}case"TrustedScriptURL":{Ne=z.createScriptURL(Ne);break}}if(Ne!==nn)try{qe?o.setAttributeNS(qe,Ae,Ne):o.setAttribute(Ae,Ne),tn(o)?it(o):rr(e.removed)}catch{yt(Ae,o)}}pt(B.afterSanitizeAttributes,o,null)},Pr=function D(o){let g=null;const E=zn(o);for(pt(B.beforeSanitizeShadowDOM,o,null);g=E.nextNode();)pt(B.uponSanitizeShadowNode,g,null),Bn(g),Fn(g),g.content instanceof s&&D(g.content);pt(B.afterSanitizeShadowDOM,o,null)};return e.sanitize=function(D){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=null,E=null,ke=null,Pe=null;if(F=!D,F&&(D="<!-->"),typeof D!="string"&&!$n(D))if(typeof D.toString=="function"){if(D=D.toString(),typeof D!="string")throw Nt("dirty is not a string, aborting")}else throw Nt("toString is not a function");if(!e.isSupported)return D;if(_e||en(o),e.removed=[],typeof D=="string"&&(_=!1),_){if(D.nodeName){const ht=Re(D.nodeName);if(!A[ht]||C[ht])throw Nt("root node is forbidden and cannot be sanitized in-place")}}else if(D instanceof c)g=Pn("<!---->"),E=g.ownerDocument.importNode(D,!0),E.nodeType===zt.element&&E.nodeName==="BODY"||E.nodeName==="HTML"?g=E:g.appendChild(E);else{if(!Ce&&!Ze&&!U&&D.indexOf("<")===-1)return z&&ze?z.createHTML(D):D;if(g=Pn(D),!g)return Ce?null:ze?re:""}g&&Ee&&it(g.firstChild);const Ae=zn(_?D:g);for(;ke=Ae.nextNode();)Bn(ke),Fn(ke),ke.content instanceof s&&Pr(ke.content);if(_)return D;if(Ce){if(Ge)for(Pe=Z.call(g.ownerDocument);g.firstChild;)Pe.appendChild(g.firstChild);else Pe=g;return(S.shadowroot||S.shadowrootmode)&&(Pe=$.call(a,Pe,!0)),Pe}let qe=U?g.outerHTML:g.innerHTML;return U&&A["!doctype"]&&g.ownerDocument&&g.ownerDocument.doctype&&g.ownerDocument.doctype.name&&$e(Rr,g.ownerDocument.doctype.name)&&(qe="<!DOCTYPE "+g.ownerDocument.doctype.name+`>
`+qe),Ze&&jt([ae,ve,me],ht=>{qe=Ot(qe,ht," ")}),z&&ze?z.createHTML(qe):qe},e.setConfig=function(){let D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};en(D),_e=!0},e.clearConfig=function(){Ct=null,_e=!1},e.isValidAttribute=function(D,o,g){Ct||en({});const E=Re(D),ke=Re(o);return Un(E,ke,g)},e.addHook=function(D,o){typeof o=="function"&&Dt(B[D],o)},e.removeHook=function(D,o){if(o!==void 0){const g=ns(B[D],o);return g===-1?void 0:rs(B[D],g,1)[0]}return rr(B[D])},e.removeHooks=function(D){B[D]=[]},e.removeAllHooks=function(){B=cr()},e}var Mr=Lr();function Ye(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}let dn=null;async function ks(){return dn||(dn=wn(async()=>{const{createHighlighter:n}=await import("./DcOAMOlN.js");return{createHighlighter:n}},__vite__mapDeps([0,1,2]),import.meta.url).then(({createHighlighter:n})=>n({themes:["github-dark-default"],langs:["javascript","typescript","python","rust","go","java","html","css","json","yaml","bash","sql","markdown","svelte"]}))),dn}let pn=null;async function _s(){return pn||(pn=wn(async()=>{const{default:n}=await import("./Dg6LpIYP.js").then(e=>e.bE);return{default:n}},__vite__mapDeps([3,1,2]),import.meta.url).then(({default:n})=>(n.initialize({startOnLoad:!1,theme:"dark",themeVariables:{primaryColor:"#00e5ff",primaryTextColor:"#e2e8f0",primaryBorderColor:"#1e293b",lineColor:"#64748b",secondaryColor:"#7c4dff",tertiaryColor:"#0a0e1a",background:"#0a0e1a",mainBkg:"#111827",secondBkg:"#1a1f35",tertiaryBkg:"#0d1220"}}),n))),pn}const ws={name:"math",level:"inline",start(n){return n.indexOf("$")},tokenizer(n){const e=n.match(/^\$\$([^$]+)\$\$/);if(e)return{type:"math",raw:e[0],text:e[1].trim(),displayMode:!0};const t=n.match(/^\$([^$\n]+)\$/);if(t)return{type:"math",raw:t[0],text:t[1].trim(),displayMode:!1}},renderer(n){const e=encodeURIComponent(n.text),t=n.displayMode?"true":"false";return n.displayMode?`<div class="katex-placeholder" data-math="${e}" data-display="${t}"><span class="text-text-muted text-xs">Loading mathâ€¦</span></div>`:`<span class="katex-placeholder" data-math="${e}" data-display="${t}">â‹¯</span>`}},Ht=new Bt;Ht.code=function({text:n,lang:e}){const t=e||"";if(t==="mermaid"){const s=`mermaid-${Math.random().toString(36).substr(2,9)}`;return`<div class="mermaid-wrapper">
      <div class="mermaid" data-diagram="${Ye(n)}" id="${s}">
        <!-- Mermaid will render here -->
      </div>
    </div>`}return`<div class="code-wrapper">${t?`<div class="code-block-header"><span>${Ye(t)}</span><button class="copy-btn" onclick="navigator.clipboard.writeText(decodeURIComponent(this.dataset.code)).then(()=>{this.textContent='Copied!';setTimeout(()=>this.textContent='Copy',1500)})" data-code="${encodeURIComponent(n)}">Copy</button></div>`:""}<pre><code class="shiki-code" data-lang="${Ye(t)}" data-code="${Ye(n)}">${Ye(n)}</code></pre></div>`};Ht.link=function({href:n,title:e,text:t}){const a=e?` title="${Ye(e)}"`:"";return`<a href="${Ye(n)}"${a} target="_blank" rel="noopener noreferrer">${t}</a>`};Ht.table=function(n){return`<div class="table-wrapper overflow-x-auto"><table>${n.header}${n.body}</table></div>`};Ht.image=function({href:n,title:e,text:t}){const a=e?` title="${Ye(e)}"`:"",r=t?` alt="${Ye(t)}"`:"";return`<img src="${Ye(n)}"${r}${a} loading="lazy" decoding="async" />`};const ys=new Sr({renderer:Ht,gfm:!0,breaks:!0,extensions:[ws]});function Ts(n){try{const e=ys.parse(n);if(e instanceof Promise)return Ye(n);const t=typeof e=="string"?e:String(e);return fr&&typeof window<"u"?Mr.sanitize(t,{ADD_TAGS:["iframe","svg"],ADD_ATTR:["target","rel","data-code","data-lang","data-diagram","data-math","data-display","loading","decoding"],ALLOW_DATA_ATTR:!0}):t}catch{return Ye(n)}}async function As(n){let e=n;{const t=await ks(),a=e.match(/<code class="shiki-code"[^>]*>[\s\S]*?<\/code>/g);if(a)for(const l of a){const c=l.match(/data-lang="([^"]*)"/),u=l.match(/data-code="([^"]*)"/)?.[1];if(u){const y=c?.[1]||"text",b=decodeURIComponent(u);try{const N=t.codeToHtml(b,{lang:y,theme:"github-dark-default"}).match(/<pre[^>]*><code[^>]*>([\s\S]*?)<\/code><\/pre>/);if(N){const M=l.replace(/<code class="shiki-code"[^>]*>[\s\S]*?<\/code>/,`<code class="shiki">${N[1]}</code>`);e=e.replace(l,M)}}catch{}}}const r=e.match(/<(?:div|span) class="katex-placeholder"[^>]*>[\s\S]*?<\/(?:div|span)>/g);if(r){const l=(await wn(async()=>{const{default:c}=await import("./DhXJpUyf.js");return{default:c}},[],import.meta.url)).default;for(const c of r){const d=c.match(/data-math="([^"]*)"/),u=c.match(/data-display="([^"]*)"/);if(d){const y=decodeURIComponent(d[1]),b=u?.[1]==="true";try{const w=l.renderToString(y,{displayMode:b,throwOnError:!1,errorColor:"#f43f9e",trust:!0});e=e.replace(c,w)}catch{e=e.replace(c,`<code class="math-error">${Ye(y)}</code>`)}}}}const s=e.match(/<div class="mermaid"[^>]*>[\s\S]*?<\/div>/g);if(s){const l=await _s();for(const c of s){const u=c.match(/data-diagram="([^"]*)"/)?.[1],b=c.match(/id="([^"]*)"/)?.[1];if(u&&b){const w=decodeURIComponent(u);try{const{svg:N}=await l.render(b,w),M=`<div class="mermaid-rendered">${N}</div>`;e=e.replace(c,M)}catch(N){console.warn("Mermaid rendering failed:",N);const M=`<div class="mermaid-error">
              <p>Mermaid diagram could not be rendered</p>
              <pre><code>${Ye(w)}</code></pre>
            </div>`;e=e.replace(c,M)}}}}}return typeof window<"u"?Mr.sanitize(e,{ADD_TAGS:["iframe","svg"],ADD_ATTR:["target","rel","data-code","data-lang","data-diagram","data-math","data-display","viewBox","xmlns","loading","decoding"],ALLOW_DATA_ATTR:!0}):e}var Ss=k('<span class="thinking-dots svelte-1mu9o59">Thinking</span>'),Es=k('<span class="text-text-muted svelte-1mu9o59"> </span>'),Cs=k(`<div class="mt-2 text-xs text-text-secondary bg-accent-purple/3 border border-accent-purple/10 
             rounded-lg p-3 whitespace-pre-wrap animate-fade-in svelte-1mu9o59" style="font-family: var(--font-mono); line-height: 1.4"> </div>`),Rs=k(`<div class="thinking-block my-2 svelte-1mu9o59"><button class="flex items-center gap-2 text-xs text-accent-purple hover:text-accent-purple/80 
           bg-accent-purple/5 hover:bg-accent-purple/10 border border-accent-purple/20 
           rounded-lg px-3 py-2 transition-all duration-200 w-full text-left svelte-1mu9o59" style="box-shadow: 0 0 8px rgba(124, 77, 255, 0.1)"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="svelte-1mu9o59"></path></svg> <span class="font-medium svelte-1mu9o59"><!></span> <!></button> <!></div>`);function Ls(n,e){xt(e,!0);let t=Qe(e,"isStreaming",3,!1),a=ue(!1);var r=Rs(),s=h(r),l=h(s),c=x(l,2),d=h(c);{var u=P=>{var G=Ss();f(P,G)},y=P=>{var G=wt("Thinking");f(P,G)};L(d,P=>{t()?P(u):P(y,!1)})}p(c);var b=x(c,2);{var w=P=>{var G=Es(),W=h(G);p(G),H(()=>K(W,`(${e.thinkingContent.length??""} chars)`)),f(P,G)};L(b,P=>{i(a)||P(w)})}p(s);var N=x(s,2);{var M=P=>{var G=Cs(),W=h(G,!0);p(G),H(()=>K(W,e.thinkingContent)),f(P,G)};L(N,P=>{i(a)&&P(M)})}p(r),H(()=>Se(l,0,`w-3 h-3 transition-transform duration-200 ${i(a)?"rotate-90":""}`,"svelte-1mu9o59")),de("click",s,()=>O(a,!i(a))),f(n,r),kt()}bt(["click"]);var Ms=k(`<button class="text-xs text-text-muted hover:text-accent-cyan px-2 py-1 rounded
                 bg-bg-tertiary hover:bg-bg-hover border border-border-default transition-colors"> </button>`),Is=k(`<button class="text-xs text-text-muted hover:text-accent-cyan px-2 py-1 rounded
                 bg-bg-tertiary hover:bg-bg-hover border border-border-default transition-colors"> </button>`),Ds=k(`<div class="border-t border-border-default bg-bg-primary/30"><div class="p-3"><h4 class="text-xs font-medium text-text-secondary mb-2 uppercase tracking-wider">Input Parameters</h4> <pre class="text-xs text-text-primary bg-bg-input border border-border-default rounded p-3 
                   overflow-x-auto font-mono"> </pre></div></div>`),Os=k('<div><div class="p-3"><h4 class="text-xs font-medium text-text-secondary mb-2 uppercase tracking-wider"> </h4> <pre> </pre></div></div>'),Ns=k('<div class="border-t border-border-default bg-accent-cyan/5"><div class="p-3 flex items-center gap-3"><div class="flex items-center gap-1"><div class="w-2 h-2 rounded-full bg-accent-cyan animate-pulse" style="animation-delay: 0s"></div> <div class="w-2 h-2 rounded-full bg-accent-cyan animate-pulse" style="animation-delay: 0.2s"></div> <div class="w-2 h-2 rounded-full bg-accent-cyan animate-pulse" style="animation-delay: 0.4s"></div></div> <span class="text-xs text-accent-cyan font-medium">Executing...</span></div></div>'),Ps=k('<div class="tool-call-card my-3 border border-border-default rounded-lg bg-bg-tertiary overflow-hidden"><div class="flex items-center justify-between p-3 bg-bg-surface/50"><div class="flex items-center gap-3"><div class="flex items-center gap-2"><span class="text-lg"> </span> <span class="font-mono font-medium text-sm text-text-primary"> </span></div> <div class="flex items-center gap-1"><div></div> <span class="text-xs font-medium"> </span></div></div> <div class="flex items-center gap-2"><!> <!></div></div> <!> <!> <!></div>');function zs(n,e){xt(e,!0);let t=Qe(e,"isExecuting",3,!1),a=Qe(e,"isHistorical",3,!1),r=ue(!1),s=ue(!1);function l(q){try{return JSON.stringify(q,null,2)}catch{return String(q)}}let c=J(()=>t()?{text:"Running",cssColor:"var(--color-accent-cyan)",icon:"âš¡",pulse:!0}:e.toolResult?.isError?{text:"Error",cssColor:"#f87171",icon:"âœ•",pulse:!1}:e.toolResult?{text:"Complete",cssColor:"var(--color-accent-green, #34d399)",icon:"âœ“",pulse:!1}:a()?{text:"Done",cssColor:"var(--color-accent-green, #34d399)",icon:"âœ“",pulse:!1}:{text:"Pending",cssColor:"var(--color-text-muted, #888)",icon:"â³",pulse:!1}),d=J(()=>!!(e.toolCall.input||e.toolCall.arguments)),u=J(()=>!!e.toolResult?.content);var y=Ps(),b=h(y),w=h(b),N=h(w),M=h(N),P=h(M,!0);p(M);var G=x(M,2),W=h(G,!0);p(G),p(N);var ge=x(N,2),pe=h(ge),z=x(pe,2),re=h(z,!0);p(z),p(ge),p(w);var he=x(w,2),T=h(he);{var Z=q=>{var j=Ms(),ee=h(j);p(j),H(()=>K(ee,`Input ${i(r)?"â–¼":"â–¶"}`)),de("click",j,()=>O(r,!i(r))),f(q,j)};L(T,q=>{i(d)&&q(Z)})}var I=x(T,2);{var $=q=>{var j=Is(),ee=h(j);p(j),H(()=>K(ee,`Output ${i(s)?"â–¼":"â–¶"}`)),de("click",j,()=>O(s,!i(s))),f(q,j)};L(I,q=>{i(u)&&q($)})}p(he),p(b);var B=x(b,2);{var ae=q=>{var j=Ds(),ee=h(j),te=x(h(ee),2),A=h(te,!0);p(te),p(ee),p(j),H(v=>K(A,v),[()=>l(e.toolCall.input||e.toolCall.arguments)]),f(q,j)};L(B,q=>{i(r)&&i(d)&&q(ae)})}var ve=x(B,2);{var me=q=>{var j=Os(),ee=h(j),te=h(ee),A=h(te,!0);p(te);var v=x(te,2),S=h(v,!0);p(v),p(ee),p(j),H(()=>{Se(j,1,`border-t border-border-default ${e.toolResult?.isError?"bg-red-950/20":"bg-bg-primary/30"}`),K(A,e.toolResult?.isError?"Error Output":"Result"),Se(v,1,`text-xs ${e.toolResult?.isError?"text-red-300":"text-text-primary"} 
                   bg-bg-input border border-border-default rounded p-3 overflow-x-auto font-mono 
                   whitespace-pre-wrap max-h-96`),K(S,e.toolResult?.content)}),f(q,j)};L(ve,q=>{i(s)&&i(u)&&q(me)})}var xe=x(ve,2);{var Te=q=>{var j=Ns();f(q,j)};L(xe,q=>{t()&&q(Te)})}p(y),H(()=>{K(P,i(c).icon),K(W,e.toolCall.name),Se(pe,1,`w-2 h-2 rounded-full ${i(c).pulse?"animate-pulse":""}`),gn(pe,`background-color: ${i(c).cssColor??""}`),gn(z,`color: ${i(c).cssColor??""}`),K(re,i(c).text)}),f(n,y),kt()}bt(["click"]);var $s=k('<div class="fixed inset-0 z-[9999] flex items-center justify-center bg-black/85 backdrop-blur-sm animate-fade-in" role="dialog" aria-modal="true" aria-label="Image preview"><button class="absolute top-4 right-4 z-10 p-2 rounded-full glass-strong text-text-muted hover:text-accent-cyan transition-colors" aria-label="Close lightbox"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button> <img class="max-w-[95vw] max-h-[90vh] object-contain rounded-lg shadow-2xl select-none" draggable="false"/></div>');function Bs(n,e){xt(e,!0);let t=Qe(e,"src",3,""),a=Qe(e,"alt",3,""),r=Qe(e,"open",3,!1);function s(){e.onclose?.()}function l(b){b.key==="Escape"&&s()}function c(b){b.target===b.currentTarget&&s()}var d=Lt(),u=tt(d);{var y=b=>{var w=$s(),N=h(w),M=x(N,2);p(w),H(()=>{Be(M,"src",t()),Be(M,"alt",a())}),de("click",w,c),de("keydown",w,l),de("click",N,s),f(b,w)};L(u,b=>{r()&&fr&&b(y)})}f(n,d),kt()}bt(["click","keydown"]);var Us=k('<div class="flex-shrink-0 mr-2.5 mt-5 hidden md:block svelte-1e5n1dp"><img src="/images/ranaye-avatar.png" alt="Ranaye" class="w-8 h-8 rounded-full object-cover border border-accent-purple/30 shadow-[0_0_8px_rgba(124,77,255,0.2)] svelte-1e5n1dp"/></div>'),Hs=k('<span class="text-xs font-medium text-accent-purple svelte-1e5n1dp">Ranaye</span>'),Fs=k('<span class="text-xs font-medium text-accent-cyan svelte-1e5n1dp"> </span>'),js=k('<span class="text-[10px] font-medium px-1.5 py-0.5 rounded-full leading-none svelte-1e5n1dp"> </span>'),Gs=k('<span class="text-xs text-text-muted opacity-0 group-hover:opacity-100 transition-opacity duration-200 select-none svelte-1e5n1dp"> </span>'),Ws=k('<span class="text-xs text-amber-400 font-medium svelte-1e5n1dp">âš¡ Aborted</span>'),qs=k('<span class="text-xs text-red-400 font-medium svelte-1e5n1dp">âœ• Error</span>'),Ys=Vt('<svg class="w-3.5 h-3.5 svelte-1e5n1dp" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 13l4 4L19 7" class="svelte-1e5n1dp"></path></svg>'),Zs=Vt('<svg class="w-3 h-3 svelte-1e5n1dp" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" class="svelte-1e5n1dp"></path></svg>'),Vs=k('<button class="block cursor-pointer bg-transparent border-0 p-0 svelte-1e5n1dp"><img class="max-w-[200px] md:max-w-xs max-h-48 md:max-h-64 rounded-lg border border-border-default hover:border-accent-cyan/50 transition-colors cursor-pointer object-contain svelte-1e5n1dp" loading="lazy"/></button>'),Ks=k("<div></div>"),Xs=k('<div class="markdown-content text-sm svelte-1e5n1dp"><!></div>'),Qs=k('<button class="block cursor-pointer bg-transparent border-0 p-0 svelte-1e5n1dp" aria-label="View image fullscreen"><img class="max-w-[200px] md:max-w-sm max-h-48 md:max-h-64 rounded-lg border border-border-default hover:border-accent-cyan/50 transition-colors cursor-pointer object-contain svelte-1e5n1dp" loading="lazy"/></button>'),Js=k('<div class="mt-2 flex flex-wrap gap-2 svelte-1e5n1dp"></div>'),ei=k('<div class="flex items-center gap-2 py-1 svelte-1e5n1dp"><div class="flex items-center gap-1 svelte-1e5n1dp"><span class="typing-dot svelte-1e5n1dp"></span> <span class="typing-dot svelte-1e5n1dp" style="animation-delay: 0.15s"></span> <span class="typing-dot svelte-1e5n1dp" style="animation-delay: 0.3s"></span></div> <span class="text-xs text-text-muted svelte-1e5n1dp">Thinking...</span></div>'),ti=k('<span class="inline-block w-0.5 h-4 bg-accent-cyan ml-0.5 animate-pulse align-middle svelte-1e5n1dp"></span>'),ni=k("<div><!> <!> <!> <!> <!></div>"),ri=k('<img alt="You" class="w-8 h-8 rounded-full object-cover border border-accent-cyan/30 shadow-[0_0_8px_rgba(0,229,255,0.15)] svelte-1e5n1dp"/>'),ai=k('<div class="w-8 h-8 rounded-full bg-accent-cyan/20 border border-accent-cyan/30 flex items-center justify-center shadow-[0_0_8px_rgba(0,229,255,0.15)] svelte-1e5n1dp"><svg class="w-4 h-4 text-accent-cyan svelte-1e5n1dp" fill="currentColor" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" class="svelte-1e5n1dp"></path></svg></div>'),si=k('<div class="flex-shrink-0 ml-2.5 mt-5 hidden md:block svelte-1e5n1dp"><!></div>'),ii=k('<div><!> <div role="article"><div><!> <!> <!> <!> <!> <button><!></button></div> <!> <!> <!></div> <!></div> <!>',1);function ur(n,e){xt(e,!0);let t=ue(null),a=ue("");At(()=>{O(t,localStorage.getItem("cortex-user-avatar"),!0),O(a,localStorage.getItem("cortex-user-name")||"",!0)});let r=Qe(e,"streaming",3,!1),s=Qe(e,"streamingContent",3,""),l=Qe(e,"streamingThinkingContent",3,""),c=Qe(e,"streamingToolCalls",19,()=>[]),d=Qe(e,"showChannel",3,!1),u=ue(!1),y=ue(""),b=ue("");function w(_,R){O(y,_,!0),O(b,R,!0),O(u,!0)}function N(){O(u,!1)}const M={discord:{label:"Discord",color:"#5865F2",bg:"rgba(88,101,242,0.15)"},telegram:{label:"Telegram",color:"#0088cc",bg:"rgba(0,136,204,0.15)"},webchat:{label:"Web",color:"#00e5ff",bg:"rgba(0,229,255,0.12)"},signal:{label:"Signal",color:"#3A76F0",bg:"rgba(58,118,240,0.15)"},whatsapp:{label:"WhatsApp",color:"#25D366",bg:"rgba(37,211,102,0.15)"},slack:{label:"Slack",color:"#4A154B",bg:"rgba(74,21,75,0.25)"}};let P=J(()=>{if(!d()||!e.message?.channel)return null;const _=e.message.channel.toLowerCase();return M[_]??{label:e.message.channel,color:"#888",bg:"rgba(136,136,136,0.12)"}}),G=ue(!1),W=ue(!1),ge=ue(""),pe=J(()=>e.message?.role??"assistant"),z=J(()=>r()?s():e.message?.content??""),re=J(()=>i(pe)==="user"),he=J(()=>e.message?.timestamp?new Date(e.message.timestamp):null),T=ue(dr(Date.now())),Z=J(()=>i(he)?ea(i(he).getTime()):null);At(()=>{if(!i(he))return;const _=setInterval(()=>{O(T,Date.now(),!0)},3e4);return()=>clearInterval(_)});const I=/(?:!\[([^\]]*)\]\((https?:\/\/[^\s)]+\.(?:png|jpg|jpeg|gif|webp|svg)(?:\?[^\s)]*)?)\))|(?:^|\s)(https?:\/\/[^\s]+\.(?:png|jpg|jpeg|gif|webp|svg)(?:\?[^\s]*)?)(?:\s|$)/gi;let $=J(()=>{if(!i(z))return[];const _=[],R=new Set;let Q;const Ie=new RegExp(I.source,I.flags);for(;(Q=Ie.exec(i(z)))!==null;){const Le=Q[2]||Q[3];Le&&!R.has(Le)&&(R.add(Le),_.push({url:Le,alt:Q[1]||"Image"}))}return _});At(()=>{if(i(z)){const _=Ts(i(z));O(ge,_,!0),As(_).then(R=>{O(ge,R,!0)})}else O(ge,"")});let B=J(()=>{let _=i(z);const R=r()?l():e.message?.thinkingContent;return R&&(_=`[Thinking]
${R}

${_}`),_}),ae=J(()=>r()?l():e.message?.thinkingContent),ve=J(()=>r()?c():e.message?.toolCalls);async function me(){if(i(B))try{await navigator.clipboard.writeText(i(B)),O(W,!0),setTimeout(()=>{O(W,!1)},2e3)}catch(_){console.error("Failed to copy message:",_)}}var xe=ii(),Te=tt(xe),q=h(Te);{var j=_=>{var R=Us(),Q=h(R);p(R),ft("error",Q,Ie=>{Ie.target.style.display="none"}),qn(Q),f(_,R)};L(q,_=>{i(re)||_(j)})}var ee=x(q,2),te=h(ee),A=h(te);{var v=_=>{var R=Hs();f(_,R)},S=_=>{var R=Fs(),Q=h(R,!0);p(R),H(()=>K(Q,i(a)||"You")),f(_,R)};L(A,_=>{i(re)?_(S,!1):_(v)})}var we=x(A,2);{var m=_=>{var R=js(),Q=h(R,!0);p(R),H(()=>{gn(R,`color: ${i(P).color??""}; background: ${i(P).bg??""}; border: 1px solid ${i(P).color??""}33;`),K(Q,i(P).label)}),f(_,R)};L(we,_=>{i(P)&&_(m)})}var C=x(we,2);{var le=_=>{var R=Gs(),Q=h(R,!0);p(R),H(Ie=>{Be(R,"title",Ie),K(Q,i(Z))},[()=>i(he)?.toLocaleString()]),f(_,R)};L(C,_=>{i(Z)&&_(le)})}var X=x(C,2);{var se=_=>{var R=Ws();f(_,R)};L(X,_=>{e.message?.isAborted&&_(se)})}var ye=x(X,2);{var je=_=>{var R=qs();f(_,R)};L(ye,_=>{e.message?.isError&&_(je)})}var Me=x(ye,2),Ze=h(Me);{var ie=_=>{var R=Ys();f(_,R)},U=_=>{var R=Zs();f(_,R)};L(Ze,_=>{i(W)?_(ie):_(U,!1)})}p(Me),p(te);var _e=x(te,2);{var Ee=_=>{Ls(_,{get thinkingContent(){return i(ae)},get isStreaming(){return r()}})};L(_e,_=>{!i(re)&&i(ae)&&_(Ee)})}var Ce=x(_e,2);{var Ge=_=>{var R=ni(),Q=h(R);{var Ie=F=>{var ne=Ks();ct(ne,21,()=>e.message.images,vt,(Ke,Je,Xe)=>{var et=Vs();Be(et,"aria-label",`View attachment ${Xe+1} fullscreen`);var st=h(et);Be(st,"alt",`Attachment ${Xe+1}`),p(et),H(()=>Be(st,"src",i(Je).dataUrl)),de("click",et,()=>w(i(Je).dataUrl,`Attachment ${Xe+1}`)),f(Ke,et)}),p(ne),H(()=>Se(ne,1,`flex flex-wrap gap-2 ${i(z)?"mb-2":""}`,"svelte-1e5n1dp")),f(F,ne)};L(Q,F=>{e.message?.images?.length&&F(Ie)})}var Le=x(Q,2);{var De=F=>{var ne=Xs(),Ke=h(ne);na(Ke,()=>i(ge)),p(ne),f(F,ne)};L(Le,F=>{i(z)&&F(De)})}var Oe=x(Le,2);{var ut=F=>{var ne=Js();ct(ne,21,()=>i($),vt,(Ke,Je)=>{var Xe=Qs(),et=h(Xe);p(Xe),H(()=>{Be(et,"src",i(Je).url),Be(et,"alt",i(Je).alt)}),de("click",Xe,()=>w(i(Je).url,i(Je).alt)),ft("error",et,st=>{st.target.style.display="none"}),qn(et),f(Ke,Xe)}),p(ne),f(F,ne)};L(Oe,F=>{i($).length>0&&F(ut)})}var dt=x(Oe,2);{var _t=F=>{var ne=ei();f(F,ne)};L(dt,F=>{r()&&!i(z)&&!i(ae)&&!i(ve)?.length&&F(_t)})}var Ve=x(dt,2);{var ce=F=>{var ne=ti();f(F,ne)};L(Ve,F=>{r()&&i(z)&&F(ce)})}p(R),H(()=>Se(R,1,`rounded-2xl px-2.5 py-2.5 md:px-4 md:py-3 ${i(re)?"bg-accent-cyan/10 border border-accent-cyan/20":"glass"} ${r()?"border-accent-purple/30":""}`,"svelte-1e5n1dp")),f(_,R)};L(Ce,_=>{(i(z)||e.message?.images?.length||i($).length>0||r())&&_(Ge)})}var ze=x(Ce,2);{var at=_=>{var R=Lt(),Q=tt(R);ct(Q,17,()=>i(ve),vt,(Ie,Le)=>{const De=J(()=>e.message?.toolResults?.find(Oe=>Oe.toolCallId===i(Le).id));{let Oe=J(()=>r()&&!i(De)),ut=J(()=>e.message?.isHistorical??!1);zs(Ie,{get toolCall(){return i(Le)},get toolResult(){return i(De)},get isExecuting(){return i(Oe)},get isHistorical(){return i(ut)}})}}),f(_,R)};L(ze,_=>{i(ve)?.length&&_(at)})}p(ee);var V=x(ee,2);{var be=_=>{var R=si(),Q=h(R);{var Ie=De=>{var Oe=ri();H(()=>Be(Oe,"src",i(t))),f(De,Oe)},Le=De=>{var Oe=ai();f(De,Oe)};L(Q,De=>{i(t)?De(Ie):De(Le,!1)})}p(R),f(_,R)};L(V,_=>{i(re)&&_(be)})}p(Te);var We=x(Te,2);Bs(We,{get src(){return i(y)},get alt(){return i(b)},get open(){return i(u)},onclose:N}),H(()=>{Se(Te,1,`flex ${i(re)?"justify-end":"justify-start"} animate-slide-in-up mb-3 md:mb-4 px-2 md:px-0`,"svelte-1e5n1dp"),Se(ee,1,`max-w-[90%] md:max-w-[80%] ${i(re)?"ml-8 md:ml-12":""} group`,"svelte-1e5n1dp"),Se(te,1,`flex items-center gap-2 mb-1 ${i(re)?"justify-end":""}`,"svelte-1e5n1dp"),Se(Me,1,`text-xs p-1.5 md:p-1 rounded-md transition-all duration-200
               min-h-6 min-w-6 flex items-center justify-center
               ${i(W)?"text-accent-green opacity-100":"text-text-muted hover:text-accent-cyan opacity-0 group-hover:opacity-100"}
               ${i(B)?"":"hidden"}`,"svelte-1e5n1dp"),Be(Me,"aria-label",i(W)?"Copied!":"Copy message"),Be(Me,"title",i(W)?"Copied!":"Copy message")}),ft("mouseenter",ee,()=>O(G,!0)),ft("mouseleave",ee,()=>{O(G,!1)}),de("click",Me,me),f(n,xe),kt()}bt(["click"]);var oi=k('<div class="flex items-center justify-center py-12"><div class="flex items-center gap-3 text-text-muted"><svg class="w-5 h-5 animate-spin" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> <span class="text-sm">Loading history...</span></div></div>'),li=k('Configure your gateway connection in <a href="/settings" class="text-accent-cyan hover:underline">Settings</a> to get started.',1),ci=k(`<button class="flex items-center gap-3 px-4 py-3 rounded-xl text-left
                       glass hover:bg-bg-hover border border-border-default hover:border-accent-cyan/30
                       transition-all duration-200 group/action"><span class="text-xl"> </span> <span class="text-sm text-text-secondary group-hover/action:text-text-primary transition-colors"> </span></button>`),ui=k('<div class="grid grid-cols-2 gap-3 w-full max-w-lg"></div>'),di=k('<div class="flex flex-col items-center justify-center py-16 md:py-24 text-center animate-fade-in"><div class="relative mb-8"><div class="absolute inset-0 w-32 h-32 md:w-40 md:h-40 rounded-full bg-accent-cyan/10 blur-2xl"></div> <img src="/logo.png" alt="Cortex" class="relative w-32 h-32 md:w-40 md:h-40 drop-shadow-lg"/></div> <h2 class="text-2xl md:text-3xl font-bold gradient-text mb-3"><!></h2> <p class="text-text-muted text-sm md:text-base max-w-md mb-8"><!></p> <!></div>'),pi=k('<div class="flex items-center justify-center my-6"><div class="flex-1 h-px bg-border-default"></div> <span class="px-4 text-xs text-text-muted font-medium bg-bg-primary"> </span> <div class="flex-1 h-px bg-border-default"></div></div>'),hi=k('<div class="virtual-item"><!></div>'),fi=k("<!> <!>",1),gi=k('<span class="text-xs font-medium"> </span>'),mi=k(`<button class="fixed bottom-24 right-8 flex items-center gap-2 px-4 py-2.5 rounded-full glass-strong border-accent-cyan/30
        text-accent-cyan hover:text-accent-cyan hover:border-accent-cyan/50 hover:scale-105
        transition-all duration-200 shadow-xl animate-fade-in z-30" style="box-shadow: 0 0 20px rgba(124, 77, 255, 0.15), 0 4px 20px rgba(0, 0, 0, 0.3)" aria-label="Scroll to bottom"><!> <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg></button>`),vi=k('<div class="flex-1 overflow-y-auto px-4 py-6"><div class="max-w-4xl mx-auto"><!></div> <!></div>');function bi(n,e){xt(e,!0);const t=Xt(),a=Kt(),r=yn();let s=ue(void 0),l=ue(!0),c=ue(0),d=ue(0);At(()=>{const I=t.list.length;t.streamingContent,i(l)&&i(s)?(Yr().then(()=>{i(s)&&(i(s).scrollTop=i(s).scrollHeight)}),O(c,0),O(d,I,!0)):I>i(d)&&(O(c,i(c)+(I-i(d))),O(d,I,!0))});function u(){if(!i(s))return;const{scrollTop:I,scrollHeight:$,clientHeight:B}=i(s),ae=i(l);O(l,$-I-B<100),i(l)&&!ae&&O(c,0)}function y(){O(l,!0),O(c,0),i(s)&&i(s).scrollTo({top:i(s).scrollHeight,behavior:"smooth"})}let b=J(()=>{const I=new Set;for(const $ of t.list)$.channel&&I.add($.channel);return I.size>1}),w=J(()=>{const I=[];let $="";for(const B of t.list){const ae=ta(B.timestamp);ae!==$&&(I.push({type:"separator",date:ae}),$=ae),I.push({type:"message",message:B})}return I}),N=J(()=>r.list.find(I=>I.key===r.activeKey)),M=J(()=>i(N)?r.getSessionTitle(i(N)):"");const P=[{emoji:"ðŸ’¬",label:"Ask a question",text:"Help me understand..."},{emoji:"âœï¸",label:"Write something",text:"Write a..."},{emoji:"ðŸ”",label:"Research a topic",text:"Research..."},{emoji:"ðŸ’¡",label:"Brainstorm ideas",text:"Brainstorm ideas for..."}];function G(I){const $=new CustomEvent("cortex:prefill",{detail:{text:I},bubbles:!0});i(s)?.dispatchEvent($)}var W=vi(),ge=h(W),pe=h(ge);{var z=I=>{var $=oi();f(I,$)},re=I=>{var $=di(),B=x(h($),2),ae=h(B);{var ve=A=>{var v=wt();H(()=>K(v,i(M))),f(A,v)},me=A=>{var v=wt("Welcome to Cortex");f(A,v)};L(ae,A=>{i(M)?A(ve):A(me,!1)})}p(B);var xe=x(B,2),Te=h(xe);{var q=A=>{var v=wt("Start a conversation â€” ask anything, explore ideas, or get help with a task.");f(A,v)},j=A=>{var v=li();Tt(2),f(A,v)};L(Te,A=>{a.state.status==="connected"?A(q):A(j,!1)})}p(xe);var ee=x(xe,2);{var te=A=>{var v=ui();ct(v,21,()=>P,vt,(S,we)=>{var m=ci(),C=h(m),le=h(C,!0);p(C);var X=x(C,2),se=h(X,!0);p(X),p(m),H(()=>{K(le,i(we).emoji),K(se,i(we).label)}),de("click",m,()=>G(i(we).text)),f(S,m)}),p(v),f(A,v)};L(ee,A=>{a.state.status==="connected"&&A(te)})}p($),f(I,$)},he=I=>{var $=fi(),B=tt($);ct(B,17,()=>i(w),vt,(me,xe)=>{var Te=Lt(),q=tt(Te);{var j=te=>{var A=pi(),v=x(h(A),2),S=h(v,!0);p(v),Tt(2),p(A),H(()=>K(S,i(xe).date)),f(te,A)},ee=te=>{var A=hi(),v=h(A);ur(v,{get message(){return i(xe).message},get showChannel(){return i(b)}}),p(A),f(te,A)};L(q,te=>{i(xe).type==="separator"?te(j):te(ee,!1)})}f(me,Te)});var ae=x(B,2);{var ve=me=>{ur(me,{streaming:!0,get streamingContent(){return t.streamingContent},get streamingThinkingContent(){return t.streamingThinkingContent},get streamingToolCalls(){return t.streamingToolCalls},showChannel:!1})};L(ae,me=>{t.streaming&&me(ve)})}f(I,$)};L(pe,I=>{t.loadingHistory?I(z):t.list.length===0&&!t.streaming?I(re,1):I(he,!1)})}p(ge);var T=x(ge,2);{var Z=I=>{var $=mi(),B=h($);{var ae=ve=>{var me=gi(),xe=h(me);p(me),H(()=>K(xe,`${i(c)??""} new`)),f(ve,me)};L(B,ve=>{i(c)>0&&ve(ae)})}Tt(2),p($),de("click",$,y),f(I,$)};L(T,I=>{i(l)||I(Z)})}p(W),fn(W,I=>O(s,I),()=>i(s)),ft("scroll",W,u),f(n,W),kt()}bt(["click"]);var xi=k('<div class="flex items-center gap-2 px-1 svelte-5wsbgm"><div class="flex items-center gap-1 svelte-5wsbgm"><span class="streaming-dot svelte-5wsbgm"></span> <span class="streaming-dot svelte-5wsbgm" style="animation-delay: 0.15s"></span> <span class="streaming-dot svelte-5wsbgm" style="animation-delay: 0.3s"></span></div> <span class="text-xs text-accent-purple font-medium svelte-5wsbgm">Ranaye is responding...</span></div>'),ki=k('<div class="flex items-center justify-center py-3 px-4 rounded-xl border-2 border-dashed border-accent-cyan/40 bg-accent-cyan/5 svelte-5wsbgm"><span class="text-sm text-accent-cyan font-medium svelte-5wsbgm">ðŸ“Ž Drop image here</span></div>'),_i=k(`<div class="relative group/att svelte-5wsbgm"><img class="h-16 w-16 md:h-20 md:w-20 object-cover rounded-lg border border-border-default svelte-5wsbgm"/> <button class="absolute -top-1.5 -right-1.5 w-5 h-5 rounded-full bg-red-500 text-white
                     flex items-center justify-center text-xs font-bold
                     opacity-0 group-hover/att:opacity-100 transition-opacity duration-150
                     hover:bg-red-400 svelte-5wsbgm" aria-label="Remove attachment">Ã—</button></div>`),wi=k('<div class="flex flex-wrap gap-2 px-1 svelte-5wsbgm"></div>'),yi=k('<div class="flex justify-end svelte-5wsbgm"><span class="text-xs text-text-muted font-mono svelte-5wsbgm"> </span></div>'),Ti=k(`<button class="flex-shrink-0 p-3 md:p-3 rounded-xl bg-red-500/20 border border-red-500/30
          text-red-400 hover:bg-red-500/30 transition-all duration-200
          min-h-11 min-w-11 md:min-h-auto md:min-w-auto
          glow-pink flex items-center justify-center svelte-5wsbgm" style="box-shadow: 0 0 15px rgba(244, 63, 158, 0.15)" aria-label="Stop response"><svg class="w-5 h-5 svelte-5wsbgm" fill="currentColor" viewBox="0 0 24 24"><rect x="6" y="6" width="12" height="12" rx="2" class="svelte-5wsbgm"></rect></svg></button>`),Ai=k('<button aria-label="Send message"><svg class="w-5 h-5 svelte-5wsbgm" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" class="svelte-5wsbgm"></path></svg></button>'),Si=k(`<div role="region" aria-label="Chat input"><div class="flex flex-col gap-2 max-w-4xl mx-auto svelte-5wsbgm"><!> <!> <!> <!> <div class="flex items-end gap-2 md:gap-3 svelte-5wsbgm"><button aria-label="Attach image" title="Attach image (or paste / drag-drop)"><svg class="w-5 h-5 svelte-5wsbgm" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" class="svelte-5wsbgm"></path></svg></button> <input type="file" accept="image/*" multiple="" class="hidden svelte-5wsbgm"/> <div class="flex-1 relative svelte-5wsbgm"><textarea aria-label="Chat message" rows="1" class="w-full resize-none rounded-xl px-3 py-4 md:px-4 md:py-3 text-sm
            bg-bg-input border border-border-default
            text-text-primary placeholder:text-text-muted
            focus:outline-none focus:border-accent-cyan/50 focus:ring-2 focus:ring-accent-cyan/20 glow-cyan
            disabled:opacity-50 disabled:cursor-not-allowed
            transition-all duration-200 svelte-5wsbgm"></textarea></div> <!></div></div></div>`);function Ei(n,e){xt(e,!0);const t=Xt(),a=Kt();let r=ue(""),s=ue(void 0),l=ue(void 0),c=ue(dr([])),d=ue(!1);At(()=>{a.state.status==="connected"&&i(s)&&i(s).focus()}),At(()=>{function m(C){const le=C.detail;le?.text&&i(s)&&(O(r,le.text,!0),i(s).focus(),requestAnimationFrame(()=>{i(s)&&(i(s).selectionStart=i(s).selectionEnd=i(r).length,i(s).style.height="auto",i(s).style.height=Math.min(i(s).scrollHeight,200)+"px")}))}return document.addEventListener("cortex:prefill",m),()=>document.removeEventListener("cortex:prefill",m)});function u(m){for(const C of m){if(!C.type.startsWith("image/"))continue;if(C.size>20*1024*1024){console.warn("Image too large (>20MB), skipping:",C.name);continue}const le=new FileReader;le.addEventListener("load",()=>{const X=le.result;O(c,[...i(c),{mimeType:C.type,dataUrl:X}],!0)}),le.readAsDataURL(C)}}function y(m){const C=m.clipboardData?.items;if(!C)return;const le=[];for(let se=0;se<C.length;se++)C[se].type.startsWith("image/")&&le.push(C[se]);if(le.length===0)return;m.preventDefault();const X=[];for(const se of le){const ye=se.getAsFile();ye&&X.push(ye)}u(X)}function b(m){m.preventDefault(),O(d,!1),m.dataTransfer?.files&&u(m.dataTransfer.files)}function w(m){m.preventDefault(),O(d,!0)}function N(){O(d,!1)}function M(m){O(c,i(c).filter((C,le)=>le!==m),!0)}function P(){i(l)?.click()}function G(m){const C=m.target;C.files&&(u(C.files),C.value="")}function W(){const m=i(r).trim().length>0,C=i(c).length>0;!m&&!C||t.streaming||a.state.status!=="connected"||(t.sendMessage(i(r),i(c).length>0?[...i(c)]:void 0),O(r,""),O(c,[],!0),i(s)&&(i(s).style.height="auto"))}function ge(m){m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),W())}function pe(){i(s)&&(i(s).style.height="auto",i(s).style.height=Math.min(i(s).scrollHeight,200)+"px")}let z=J(()=>(i(r).trim().length>0||i(c).length>0)&&!t.streaming&&a.state.status==="connected"),re=J(()=>i(r).length),he=J(()=>i(re)>500);var T=Si(),Z=h(T),I=h(Z);{var $=m=>{var C=xi();f(m,C)};L(I,m=>{t.streaming&&m($)})}var B=x(I,2);{var ae=m=>{var C=ki();f(m,C)};L(B,m=>{i(d)&&m(ae)})}var ve=x(B,2);{var me=m=>{var C=wi();ct(C,21,()=>i(c),vt,(le,X,se)=>{var ye=_i(),je=h(ye);Be(je,"alt",`Attachment ${se+1}`);var Me=x(je,2);p(ye),H(()=>Be(je,"src",i(X).dataUrl)),de("click",Me,()=>M(se)),f(le,ye)}),p(C),f(m,C)};L(ve,m=>{i(c).length>0&&m(me)})}var xe=x(ve,2);{var Te=m=>{var C=yi(),le=h(C),X=h(le);p(le),p(C),H(se=>K(X,`${se??""} characters`),[()=>i(re).toLocaleString()]),f(m,C)};L(xe,m=>{i(he)&&m(Te)})}var q=x(xe,2),j=h(q),ee=x(j,2);fn(ee,m=>O(l,m),()=>i(l));var te=x(ee,2),A=h(te);Zr(A),fn(A,m=>O(s,m),()=>i(s)),p(te);var v=x(te,2);{var S=m=>{var C=Ti();de("click",C,()=>t.abortResponse()),f(m,C)},we=m=>{var C=Ai();H(()=>{C.disabled=!i(z),Se(C,1,`flex-shrink-0 p-3 md:p-3 rounded-xl transition-all duration-200
          min-h-11 min-w-11 md:min-h-auto md:min-w-auto
          flex items-center justify-center
          ${i(z)?"bg-accent-cyan/20 border border-accent-cyan/30 text-accent-cyan hover:bg-accent-cyan/30 hover:scale-105 glow-cyan glow-pulse":"bg-bg-tertiary border border-border-default text-text-muted cursor-not-allowed opacity-50"}`,"svelte-5wsbgm")}),de("click",C,W),f(m,C)};L(v,m=>{t.streaming?m(S):m(we,!1)})}p(q),p(Z),p(T),H(()=>{Se(T,1,`p-3 md:p-4 border-t border-border-default bg-bg-secondary transition-colors duration-200
         ${i(d)?"border-accent-cyan/50 bg-accent-cyan/5":""}`,"svelte-5wsbgm"),j.disabled=a.state.status!=="connected",Se(j,1,`flex-shrink-0 p-3 md:p-3 rounded-xl transition-all duration-200
               min-h-11 min-w-11 md:min-h-auto md:min-w-auto
               flex items-center justify-center
               ${a.state.status==="connected"?"text-text-muted hover:text-accent-cyan hover:bg-bg-hover":"text-text-muted opacity-30 cursor-not-allowed"}`,"svelte-5wsbgm"),Be(A,"placeholder",a.state.status==="connected"?i(c).length>0?"Add a message or paste more images...":"Message (Shift+Enter for newline, paste images)":"Connect to gateway first..."),A.disabled=a.state.status!=="connected"}),ft("drop",T,b),ft("dragover",T,w),ft("dragleave",T,N),de("click",j,P),de("change",ee,G),de("keydown",A,ge),de("input",A,pe),ft("paste",A,y),pr(A,()=>i(r),m=>O(r,m)),f(n,T),kt()}bt(["click","change","keydown","input"]);var Ci=k('<details class="mb-4 text-left"><summary class="text-xs text-text-muted cursor-pointer hover:text-text-secondary">Error details</summary> <div class="mt-2 p-3 rounded bg-bg-tertiary text-xs font-mono text-text-secondary"> </div></details>'),Ri=k('<div class="max-w-md mx-auto text-center"><div class="gradient-border glass p-6 rounded-lg glow-red"><div class="mx-auto w-16 h-16 mb-4 flex items-center justify-center rounded-full bg-accent-red/20"><svg class="w-8 h-8 text-accent-red" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg></div> <h2 class="text-lg font-semibold text-text-primary mb-2">Something went wrong</h2> <p class="text-sm text-text-secondary mb-4">A component encountered an error and cannot be displayed.</p> <!> <button class="px-4 py-2 rounded-lg gradient-bg gradient-border glow-cyan text-sm font-medium text-text-primary hover:brightness-110 transition-all">Try Again</button></div></div>'),Li=k('<div class="flex items-center justify-center p-8"><!></div>');function Mi(n,e){xt(e,!0);const t=hr();let a=ue(!1),r=ue("");function s(b){O(a,!0),O(r,b.message||"An unexpected error occurred",!0),console.error("ErrorBoundary caught error:",b),t.error("Component Error","A component encountered an error and has been disabled.",8e3)}function l(){O(a,!1),O(r,"")}typeof window<"u"&&(window.addEventListener("error",b=>{s(new Error(b.message||"Runtime error"))}),window.addEventListener("unhandledrejection",b=>{s(new Error(b.reason?.message||"Unhandled promise rejection"))}));var c=Lt(),d=tt(c);{var u=b=>{var w=Li(),N=h(w);{var M=G=>{var W=Lt(),ge=tt(W);Kn(ge,()=>e.fallback,()=>({error:i(r),retry:l})),f(G,W)},P=G=>{var W=Ri(),ge=h(W),pe=x(h(ge),6);{var z=he=>{var T=Ci(),Z=x(h(T),2),I=h(Z,!0);p(Z),p(T),H(()=>K(I,i(r))),f(he,T)};L(pe,he=>{i(r)&&he(z)})}var re=x(pe,2);p(ge),p(W),de("click",re,l),f(G,W)};L(N,G=>{e.fallback?G(M):G(P,!1)})}p(w),f(b,w)},y=b=>{var w=Lt(),N=tt(w);Kn(N,()=>e.children),f(b,w)};L(d,b=>{i(a)?b(u):b(y,!1)})}f(n,c),kt()}bt(["click"]);var Ii=k('<div class="fixed inset-0 bg-black/50 z-40 md:hidden" role="button" tabindex="0" aria-label="Close sidebar"></div>'),Di=k('<button class="p-1.5 rounded-lg hover:bg-bg-hover text-text-muted hover:text-accent-cyan transition-colors hidden md:block" aria-label="Open sidebar"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button>'),Oi=k('<span class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[10px] font-medium bg-accent-cyan/10 text-accent-cyan border border-accent-cyan/20 leading-none"><svg class="w-2.5 h-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg> </span>'),Ni=k('<span class="text-[11px] text-text-muted font-mono"> </span>'),Pi=k('<span class="text-[10px] px-1.5 py-0.5 rounded-full bg-accent-purple/10 text-accent-purple border border-accent-purple/20 leading-none font-medium"> </span>'),zi=k('<div class="flex items-center gap-2 flex-wrap"><h2 class="text-sm font-medium text-text-primary truncate"> </h2> <!></div> <div class="flex items-center gap-2 flex-wrap mt-0.5"><!> <!></div>',1),$i=k('<h2 class="text-sm font-medium text-text-primary truncate"> </h2>'),Bi=k("<!> <!>",1),Ui=k('<h2 class="text-sm text-text-muted">No session selected</h2>'),Hi=k('<span class="w-2 h-2 rounded-full bg-accent-green" aria-hidden="true"></span> <span class="sr-only">Connected</span>',1),Fi=k('<span class="w-2 h-2 rounded-full bg-amber-500 animate-pulse" aria-hidden="true"></span> <span class="sr-only"> </span>',1),ji=k('<span class="w-2 h-2 rounded-full bg-red-500" aria-hidden="true"></span> <span class="sr-only">Disconnected</span>',1),Gi=k('<div class="flex items-center gap-2 px-4 py-1.5 bg-accent-purple/5 border-b border-accent-purple/15 animate-fade-in"><svg class="w-3.5 h-3.5 text-accent-purple animate-spin" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> <span class="text-xs text-accent-purple font-medium">Context compactingâ€¦</span></div>'),Wi=k('<div class="flex h-full relative"><!> <!> <main class="flex-1 flex flex-col min-w-0"><header class="flex items-center gap-3 px-3 py-2.5 md:px-4 md:py-3 border-b border-border-default bg-bg-secondary/50"><button class="p-2 rounded-lg hover:bg-bg-hover text-text-muted hover:text-accent-cyan transition-colors md:hidden min-h-11" aria-label="Open sidebar"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button> <!> <div class="flex-1 min-w-0"><!></div> <div class="flex items-center gap-2" role="status" aria-live="polite"><!></div></header> <!> <!> <!></main></div>');function io(n,e){xt(e,!0);const t=yn(),a=Kt(),r=Xt();let s=ue(!1),l=ue(!1),c=ue(!1),d;At(()=>{const v=hn.on("chat",S=>{S.state==="compacting"?(O(c,!0),clearTimeout(d),d=setTimeout(()=>{O(c,!1)},3e4)):(S.state==="final"||S.state==="error"||S.state==="aborted")&&(O(c,!1),clearTimeout(d))});return()=>{v(),clearTimeout(d)}});let u=J(()=>r.streamingContent.toLowerCase().includes("compacting")||r.streamingContent.toLowerCase().includes("context compaction")),y=J(()=>i(c)||i(u)),b=J(()=>t.list.find(v=>v.key===t.activeKey)),w=J(()=>i(b)?.messageCount??r.list.length);function N(){O(l,!1)}function M(v){t.setActiveSession(v),O(l,!1)}function P(v){const S=v?.thinkingLevel||v?.reasoningLevel;return!S||S==="off"||S==="none"?null:S}var G=Wi();Qr("1uha8ag",v=>{Vr(()=>{Kr.title="Chat â€” Cortex"})});var W=h(G);{var ge=v=>{var S=Ii();de("click",S,N),de("keydown",S,we=>we.key==="Escape"&&N()),f(v,S)};L(W,v=>{i(l)&&v(ge)})}var pe=x(W,2);va(pe,{onMobileSessionSelect:M,get collapsed(){return i(s)},set collapsed(v){O(s,v,!0)},get mobileOpen(){return i(l)},set mobileOpen(v){O(l,v,!0)}});var z=x(pe,2),re=h(z),he=h(re),T=x(he,2);{var Z=v=>{var S=Di();de("click",S,()=>O(s,!1)),f(v,S)};L(T,v=>{i(s)&&v(Z)})}var I=x(T,2),$=h(I);{var B=v=>{var S=Bi(),we=tt(S);ct(we,17,()=>t.list.filter(X=>X.key===t.activeKey),vt,(X,se)=>{var ye=zi(),je=tt(ye),Me=h(je),Ze=h(Me,!0);p(Me);var ie=x(Me,2);{var U=V=>{var be=Oi(),We=x(h(be));p(be),H(()=>K(We,` ${i(w)??""}`)),f(V,be)};L(ie,V=>{i(w)>0&&V(U)})}p(je);var _e=x(je,2),Ee=h(_e);{var Ce=V=>{var be=Ni(),We=h(be,!0);p(be),H(()=>K(We,i(se).model)),f(V,be)};L(Ee,V=>{i(se).model&&V(Ce)})}var Ge=x(Ee,2);{var ze=V=>{var be=Pi(),We=h(be);p(be),H(_=>K(We,`ðŸ§  ${_??""}`),[()=>P(i(se))]),f(V,be)},at=J(()=>P(i(se)));L(Ge,V=>{i(at)&&V(ze)})}p(_e),H(V=>K(Ze,V),[()=>t.getSessionTitle(i(se))]),f(X,ye)});var m=x(we,2);{var C=X=>{var se=$i(),ye=h(se,!0);p(se),H(()=>K(ye,t.activeKey)),f(X,se)},le=J(()=>!t.list.find(X=>X.key===t.activeKey));L(m,X=>{i(le)&&X(C)})}f(v,S)},ae=v=>{var S=Ui();f(v,S)};L($,v=>{t.activeKey?v(B):v(ae,!1)})}p(I);var ve=x(I,2),me=h(ve);{var xe=v=>{var S=Hi();Tt(2),f(v,S)},Te=v=>{var S=Fi(),we=x(tt(S),2),m=h(we,!0);p(we),H(()=>K(m,a.state.status)),f(v,S)},q=v=>{var S=ji();Tt(2),f(v,S)};L(me,v=>{a.state.status==="connected"?v(xe):a.state.status==="connecting"||a.state.status==="authenticating"?v(Te,1):v(q,!1)})}p(ve),p(re);var j=x(re,2);{var ee=v=>{var S=Gi();f(v,S)};L(j,v=>{i(y)&&v(ee)})}var te=x(j,2);Mi(te,{children:(v,S)=>{bi(v,{})},$$slots:{default:!0}});var A=x(te,2);Ei(A,{}),p(z),p(G),de("click",he,()=>O(l,!0)),f(n,G),kt()}bt(["click","keydown"]);export{io as _,Mr as p};
