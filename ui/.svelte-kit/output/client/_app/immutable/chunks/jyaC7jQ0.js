import{d as at,b as i,f as v,s as b,a as U,t as ot}from"./B2A7gHtL.js";import{p as st,u as z,d as l,g as r,q as V,t as g,c as ct,s as A,h as x,f as d,r as _,i as it,n as lt,j as dt}from"./qR_TM3YX.js";import{i as u}from"./DpBBTLWw.js";import{g as ut,s as j,b as vt}from"./BhtVncI_.js";import{g as ft}from"./Be_uRYmX.js";var pt=v("<span></span>"),gt=v('<span class="text-text-muted"> <!>)</span>'),xt=v('<span class="text-text-muted"> </span>'),_t=v('<span class="text-text-muted font-mono text-xs"> </span>'),mt=v('<span class="text-accent-green text-xs"> </span>'),bt=v('<!> <!> <!> <button class="ml-2 p-1 rounded hover:bg-bg-hover text-text-muted hover:text-accent-red transition-colors" title="Disconnect"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>',1),ht=v('<span class="text-red-400 truncate max-w-48"> </span>'),yt=v(`<button class="ml-2 px-2 py-1 text-xs rounded border border-border-default hover:border-accent-cyan 
             text-text-muted hover:text-accent-cyan transition-colors" title="Retry connection">Retry</button>`),$t=v('<div><div class="relative flex items-center"><span></span> <!></div> <span> </span> <!> <!> <!> <!></div>');function Mt(F,G){st(G,!0);const e=ut(),h=ft(),q={disconnected:{color:"bg-red-500",pulse:!1,label:"Disconnected"},connecting:{color:"bg-amber-500",pulse:!0,label:"Connecting..."},authenticating:{color:"bg-amber-500",pulse:!0,label:"Authenticating..."},connected:{color:"bg-accent-green",pulse:!1,label:"Connected"},error:{color:"bg-red-500",pulse:!0,label:"Error"}};let k=it(()=>q[e.state.status]??q.disconnected),o=A(0),m=A(0),f=null,I=A(""),D=A(0);z(()=>{const t=e.state.status;t==="connected"?(l(o,0),l(m,0),l(D,Date.now(),!0),f&&(clearInterval(f),f=null),r(o)>0&&h.success("Reconnected","Connection restored successfully")):t==="connecting"&&r(o)>0?H(5):t==="error"?(V(o),e.state.error&&h.error("Connection Error",e.state.error)):t==="disconnected"&&r(o)===0&&(h.warning("Disconnected","Connection lost, attempting to reconnect..."),l(o,1))}),z(()=>{if(e.state.status==="connected"&&r(D)>0){const t=setInterval(()=>{const n=Date.now()-r(D);l(I,J(n),!0)},1e3);return()=>clearInterval(t)}});function H(t){l(m,t,!0),f&&clearInterval(f),f=setInterval(()=>{V(m,-1),r(m)<=0&&(clearInterval(f),f=null)},1e3)}function J(t){const n=Math.floor(t/1e3);if(n<60)return`${n}s`;const a=Math.floor(n/60);if(a<60)return`${a}m`;const p=Math.floor(a/60);return p<24?`${p}h ${a%60}m`:`${Math.floor(p/24)}d ${p%24}h`}function K(){e.url&&e.token&&(V(o),e.connect(e.url,e.token),h.info("Retrying","Attempting to reconnect..."))}function N(){e.disconnect(),l(o,0),l(m,0),l(I,""),l(D,0),h.info("Disconnected","Manually disconnected from gateway")}var M=$t(),E=x(M),B=x(E),O=d(B,2);{var P=t=>{var n=pt();g(()=>j(n,1,`absolute block w-2 h-2 rounded-full ${r(k).color??""} animate-ping opacity-75`)),i(t,n)};u(O,t=>{r(k).pulse&&t(P)})}_(E);var R=d(E,2),Q=x(R,!0);_(R);var L=d(R,2);{var W=t=>{var n=gt(),a=x(n),p=d(a);{var y=$=>{var w=ot();g(()=>b(w,`, retry in ${r(m)??""}s`)),i($,w)};u(p,$=>{r(m)>0&&$(y)})}lt(),_(n),g(()=>b(a,`(#${r(o)??""}`)),i(t,n)};u(L,t=>{r(o)>0&&e.state.status!=="connected"&&t(W)})}var S=d(L,2);{var X=t=>{var n=bt(),a=dt(n);{var p=s=>{var c=xt(),C=x(c);_(c),g(()=>b(C,`v${e.state.serverVersion??""}`)),i(s,c)};u(a,s=>{e.state.serverVersion&&s(p)})}var y=d(a,2);{var $=s=>{var c=_t(),C=x(c,!0);_(c),g(rt=>b(C,rt),[()=>e.state.connId.substring(0,8)]),i(s,c)};u(y,s=>{e.state.connId&&s($)})}var w=d(y,2);{var et=s=>{var c=mt(),C=x(c);_(c),g(()=>b(C,`â†‘${r(I)??""}`)),i(s,c)};u(w,s=>{r(I)&&s(et)})}var nt=d(w,2);U("click",nt,N),i(t,n)};u(S,t=>{e.state.status==="connected"&&t(X)})}var T=d(S,2);{var Y=t=>{var n=ht(),a=x(n,!0);_(n),g(()=>{vt(n,"title",e.state.error),b(a,e.state.error)}),i(t,n)};u(T,t=>{e.state.status==="error"&&e.state.error&&t(Y)})}var Z=d(T,2);{var tt=t=>{var n=yt();U("click",n,K),i(t,n)};u(Z,t=>{(e.state.status==="error"||e.state.status==="disconnected")&&r(o)>0&&t(tt)})}_(M),g(()=>{j(M,1,`flex items-center gap-2 px-3 py-1.5 rounded-lg glass text-xs transition-all duration-300
            ${e.state.status==="connected"?"gradient-bg glow-green":""}`),j(B,1,`block w-2 h-2 rounded-full ${r(k).color??""} transition-colors duration-300
               ${e.state.status==="connected"?"glow-green":""}`),j(R,1,`text-text-secondary transition-colors duration-300
              ${e.state.status==="connected"?"text-accent-green":""}`),b(Q,r(k).label)}),i(F,M),ct()}at(["click"]);export{Mt as C};
